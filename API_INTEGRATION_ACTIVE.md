# ‚úÖ API –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞

## üéØ –ß—Ç–æ –ë—ã–ª–æ –°–¥–µ–ª–∞–Ω–æ

### 1. –û–±–Ω–æ–≤–ª–µ–Ω BookingService
**–§–∞–π–ª:** `lib/services/booking_service.dart`

#### –ú–µ—Ç–æ–¥ `createBooking()` - –û–ë–ù–û–í–õ–ï–ù
```dart
Future<String> createBooking(Booking booking) async
```

**–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:**
1. ‚úÖ **–û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ backend** - `POST https://titotr.ru/api/orders`
   - –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç `Booking` ‚Üí JSON –¥–ª—è API
   - –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è –≤ `DateTime`
   - –£–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç –±–∞–≥–∞–∂, –∂–∏–≤–æ—Ç–Ω—ã—Ö, –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤ –≤ `metadata`
   - –ü–æ–ª—É—á–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π ID –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞

2. ‚úÖ **–õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** - Fallback –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–µ—Ç–∏
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `SharedPreferences` —Å ID –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
   - –ü–ª–∞–Ω–∏—Ä—É–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

3. ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - Graceful degradation
   - –ï—Å–ª–∏ backend –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `offline_` –¥–ª—è –±—É–¥—É—â–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

#### –ú–µ—Ç–æ–¥ `getClientBookings()` - –û–ë–ù–û–í–õ–ï–ù
```dart
Future<List<Booking>> getClientBookings(String clientId) async
```

**–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:**
1. ‚úÖ **–ó–∞–≥—Ä—É–∑–∫–∞ —Å backend** - `GET https://titotr.ru/api/orders`
   - –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –∑–∞–∫–∞–∑—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Å–µ—Ä–≤–µ—Ä–∞
   - –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç `ApiOrder` ‚Üí `Booking`

2. ‚úÖ **–õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** - –†–µ–∑–µ—Ä–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑ `SharedPreferences` (–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—ã)
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑ `SQLite` (–∑–∞–∫–∞–∑—ã —Ç–∞–∫—Å–∏)

3. ‚úÖ **–£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤**
   - Backend –¥–∞–Ω–Ω—ã–µ –≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–µ
   - –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º ID
   - –°–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–Ω–∞—á–∞–ª–∞)

---

## üîÑ –ö–∞–∫ –≠—Ç–æ –†–∞–±–æ—Ç–∞–µ—Ç

### –°–æ–∑–¥–∞–Ω–∏–µ –ó–∞–∫–∞–∑–∞
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –∑–∞–∫–∞–∑
         ‚Üì
BookingService.createBooking()
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏‚îÇ
‚îÇ   –Ω–∞ backend    ‚îÇ ‚Üê POST /api/orders
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ –£—Å–ø–µ—à–Ω–æ?‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ                      ‚îÇ
   –î–ê                     –ù–ï–¢
    ‚îÇ                      ‚îÇ
    ‚Üì                      ‚Üì
–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å ID      –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
–æ—Ç —Å–µ—Ä–≤–µ—Ä–∞          —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º offline_
    ‚îÇ                      ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚Üì
         –ü–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å
         —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
               ‚Üì
           –ì–æ—Ç–æ–≤–æ
```

### –ó–∞–≥—Ä—É–∑–∫–∞ –ó–∞–∫–∞–∑–æ–≤
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç "–ú–æ–∏ –∑–∞–∫–∞–∑—ã"
               ‚Üì
BookingService.getClientBookings()
               ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å backend  ‚îÇ ‚Üê GET /api/orders
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îÇ –£—Å–ø–µ—à–Ω–æ?‚îÇ
          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îÇ                      ‚îÇ
         –î–ê                     –ù–ï–¢
          ‚îÇ                      ‚îÇ
          ‚Üì                      ‚Üì
    –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å         –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å
    ApiOrder ‚Üí Booking         —ç—Ç–∞–ø
          ‚îÇ                      ‚îÇ
          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚Üì
           –ó–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
           (SharedPreferences + SQLite)
                     ‚Üì
              –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã
                     ‚Üì
              –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –¥–∞—Ç–µ
                     ‚Üì
              –í–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫
```

---

## üì± –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ú–µ–∂–¥—É –¢–µ–ª–µ—Ñ–æ–Ω–∞–º–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π: –ó–∞–∫–∞–∑ –Ω–∞ –¢–µ–ª–µ—Ñ–æ–Ω–µ 1 ‚Üí –ü–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–∞ –¢–µ–ª–µ—Ñ–æ–Ω–µ 2

#### –¢–µ–ª–µ—Ñ–æ–Ω 1 (—Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞)
```dart
// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –∑–∞–∫–∞–∑: –î–æ–Ω–µ—Ü–∫ ‚Üí –†–æ—Å—Ç–æ–≤, 10000‚ÇΩ
final booking = Booking(
  pickupAddress: '–î–æ–Ω–µ—Ü–∫',
  dropoffAddress: '–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É',
  totalPrice: 10000,
  // ...
);

// –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ backend
await BookingService().createBooking(booking);

// –†–µ–∑—É–ª—å—Ç–∞—Ç:
// ‚úÖ POST https://titotr.ru/api/orders
// ‚úÖ –°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: { id: "123e4567-e89b-12d3-a456-426614174000" }
// ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ —Å —Ä–µ–∞–ª—å–Ω—ã–º ID
```

#### –¢–µ–ª–µ—Ñ–æ–Ω 2 (–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤)
```dart
// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç "–ú–æ–∏ –∑–∞–∫–∞–∑—ã"
final bookings = await BookingService().getCurrentClientBookings();

// –†–µ–∑—É–ª—å—Ç–∞—Ç:
// ‚úÖ GET https://titotr.ru/api/orders
// ‚úÖ –°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞–∫–∞–∑ —Å ID "123e4567..."
// ‚úÖ –ó–∞–∫–∞–∑ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ
```

**–í—Ä–µ–º—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:** < 1 —Å–µ–∫—É–Ω–¥–∞ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞)

---

## üõ°Ô∏è Offline Support

### –ß—Ç–æ –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ë–µ–∑ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–∞

#### –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞:
```dart
// –ù–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ backend –ø–∞–¥–∞–µ—Ç
try {
  await _ordersApi.createOrder(...);
} catch (e) {
  debugPrint('‚ö†Ô∏è –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ backend: $e');
  
  // ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
  return _createOfflineBooking(booking);
  // ID: "offline_1704096000000"
}
```

#### –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤:
```dart
// –ù–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ —Å backend –ø–∞–¥–∞–µ—Ç
try {
  final orders = await _ordersApi.getOrders();
} catch (e) {
  debugPrint('‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å backend: $e');
  
  // ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Å–≤–æ–∏ –æ—Ñ–ª–∞–π–Ω –∑–∞–∫–∞–∑—ã
}
```

### TODO: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
```dart
// lib/services/offline_sync_service.dart (–µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω)

class OfflineSyncService {
  /// –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã
  Future<void> syncPendingOrders() async {
    final offlineOrders = await _getOfflineOrders();
    
    for (final order in offlineOrders) {
      if (order.id.startsWith('offline_')) {
        try {
          // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ backend
          final apiOrder = await _ordersApi.createOrder(...);
          
          // –û–±–Ω–æ–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π ID
          await _updateOrderId(order.id, apiOrder.id);
          
          debugPrint('‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω –∑–∞–∫–∞–∑: ${order.id} ‚Üí ${apiOrder.id}');
        } catch (e) {
          debugPrint('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å ${order.id}: $e');
        }
      }
    }
  }
}
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –°–æ–∑–¥–∞–Ω–∏—è –ó–∞–∫–∞–∑–∞

1. **–° –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º:**
   ```bash
   # –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:
   flutter logs | grep "üì§ –°–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è"
   # –û–∂–∏–¥–∞–µ—Ç—Å—è:
   # ‚úÖ –ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –Ω–∞ backend —Å ID: 123e4567-...
   ```

2. **–ë–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞:**
   ```bash
   # –í—ã–∫–ª—é—á–∏—Ç—å WiFi/–º–æ–±–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   # –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:
   flutter logs | grep "‚ö†Ô∏è –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ backend"
   # –û–∂–∏–¥–∞–µ—Ç—Å—è:
   # ‚ö†Ô∏è –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ backend: ...
   # üì± –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–∫–∞–∑ –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
   ```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ó–∞–≥—Ä—É–∑–∫–∏ –ó–∞–∫–∞–∑–æ–≤

1. **–° –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º:**
   ```bash
   # –û—Ç–∫—Ä—ã—Ç—å "–ú–æ–∏ –∑–∞–∫–∞–∑—ã" –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:
   flutter logs | grep "üì• –ó–∞–≥—Ä—É–∑–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π"
   # –û–∂–∏–¥–∞–µ—Ç—Å—è:
   # ‚úÖ –ü–æ–ª—É—á–µ–Ω–æ N –∑–∞–∫–∞–∑–æ–≤ —Å backend
   ```

2. **–ë–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞:**
   ```bash
   # –í—ã–∫–ª—é—á–∏—Ç—å WiFi/–º–æ–±–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   # –û—Ç–∫—Ä—ã—Ç—å "–ú–æ–∏ –∑–∞–∫–∞–∑—ã" –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:
   flutter logs | grep "‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å backend"
   # –û–∂–∏–¥–∞–µ—Ç—Å—è:
   # ‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å backend: ...
   # üì± –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   ```

---

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### –¢–æ–∫–µ–Ω—ã
```dart
// JWT —Ç–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ flutter_secure_storage
// Access Token: —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è 1 —á–∞—Å
// Refresh Token: —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è 7 –¥–Ω–µ–π

// –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ:
headers['Authorization'] = 'Bearer $accessToken';

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏:
if (response.statusCode == 401) {
  await refreshToken();
  // –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å
}
```

### TODO: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–õ–æ–≥–∏–Ω
```dart
// lib/services/api/auth_api_service.dart (—É–∂–µ —Å–æ–∑–¥–∞–Ω)

// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
await AuthApiService().register(
  email: 'user@example.com',
  password: 'password',
  name: '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤',
  phone: '+79991234567',
);

// –õ–æ–≥–∏–Ω
await AuthApiService().login(
  email: 'user@example.com',
  password: 'password',
);

// ‚úÖ –¢–æ–∫–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ flutter_secure_storage
```

---

## üìä –î–∞–Ω–Ω—ã–µ –≤ Metadata

### –ß—Ç–æ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ metadata
```json
{
  "baggage": [
    {
      "size": "l",
      "quantity": 2,
      "pricePerExtraItem": 500,
      "customDescription": null
    }
  ],
  "pets": [
    {
      "category": "upTo5kgWithCarrier",
      "breed": "–ñ–∏–≤–æ—Ç–Ω–æ–µ –¥–æ 5 –∫–≥ –≤ –ø–µ—Ä–µ–Ω–æ—Å–∫–µ",
      "cost": 0
    }
  ],
  "passengers": [
    { "type": "adult" },
    { "type": "child" }
  ],
  "vehicleClass": "sedan",
  "tripType": "customRoute",
  "direction": "donetskToRostov"
}
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –î–∞–Ω–Ω—ã—Ö
```dart
// –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∑–∞–∫–∞–∑–∞ —Å backend
final vehicleClass = apiOrder.metadata?['vehicleClass'] as String?;
final tripType = apiOrder.metadata?['tripType'] as String?;

// TODO: –ü–æ–ª–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–≥–∞–∂–∞, –∂–∏–≤–æ—Ç–Ω—ã—Ö, –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤
```

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏

### 1. –î–æ–±–∞–≤–∏—Ç—å –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é/–õ–æ–≥–∏–Ω
- [ ] –≠–∫—Ä–∞–Ω —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- [ ] –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ª–æ–≥–∏–Ω –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 2. –°–æ–∑–¥–∞—Ç—å OfflineSyncService
- [ ] –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —Å–µ—Ç–∏
- [ ] –û—á–µ—Ä–µ–¥—å –Ω–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤

### 3. Telegram –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –î–∏—Å–ø–µ—Ç—á–µ—Ä—É
- [ ] –ü–æ–ª—É—á–∏—Ç—å Bot Token –æ—Ç @BotFather
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Chat ID –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### 4. Admin Panel API
- [ ] –≠–∫—Ä–∞–Ω —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤ (–¥–ª—è –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞)
- [ ] –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ/–æ—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–æ–≤
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

---

## üìù –†–µ–∑—é–º–µ

‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å backend API –∑–∞–≤–µ—Ä—à–µ–Ω–∞**
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ https://titotr.ru
- –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å backend
- –†–∞–±–æ—Ç–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞–º–∏
- –ï—Å—Ç—å fallback –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ

‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ—Ñ–ª–∞–π–Ω –∑–∞–∫–∞–∑–æ–≤
- –ü–æ–ª–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (–±–∞–≥–∞–∂, –∂–∏–≤–æ—Ç–Ω—ã–µ)
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–ª–æ–≥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–∏—Å–ø–µ—Ç—á–µ—Ä—É

üéØ **–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–∞ –¥–≤—É—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö!
