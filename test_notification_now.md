# üß™ –¢–ï–°–¢: –ü—Ä–æ–≤–µ—Ä–∫–∞ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –°–ï–ô–ß–ê–°

## üì± –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ 19:50

**–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è:** ~19:48  
**–í—Ä–µ–º—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:** 19:50  
**–û—Å—Ç–∞–ª–æ—Å—å:** ~2 –º–∏–Ω—É—Ç—ã

---

## ‚úÖ –ß–¢–û –í–ò–î–ù–û –í –õ–û–ì–ê–•:

```
I/flutter: üîî [1H] ‚úÖ zonedSchedule() –ó–ê–í–ï–†–®–Å–ù –£–°–ü–ï–®–ù–û!
I/flutter: ‚úÖ [1H] –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∑–∞ 1 —á–∞—Å –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è 1 ‚Üí 2
I/flutter:    –í—Ä–µ–º—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: 2025-10-22 19:50:00.000+0300
I/flutter: üìã –í—Å–µ–≥–æ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ —Å–∏—Å—Ç–µ–º–µ: 2
I/flutter:    - ID: 654609515, Title: üöó –ü–æ–µ–∑–¥–∫–∞ —á–µ—Ä–µ–∑ —á–∞—Å
I/flutter:    - ID: 789770105, Title: üöó –ü–æ–µ–∑–¥–∫–∞ —á–µ—Ä–µ–∑ —á–∞—Å
```

---

## üîç –ü–†–û–í–ï–†–ö–ê –†–ê–ó–†–ï–®–ï–ù–ò–ô

### –ö–æ–º–∞–Ω–¥–∞ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —Ç–æ—á–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (Exact Alarms)
```bash
adb shell dumpsys package com.timetotravel.app | grep "SCHEDULE_EXACT_ALARM"
```

### –ö–æ–º–∞–Ω–¥–∞ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
adb shell dumpsys package com.timetotravel.app | grep "permission"
```

### –ö–æ–º–∞–Ω–¥–∞ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
```bash
adb shell dumpsys notification | grep "com.timetotravel.app"
```

---

## üö® –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ò–ß–ò–ù–´

### 1. Android 12+ —Ç—Ä–µ–±—É–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ SCHEDULE_EXACT_ALARM

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –≤ `AndroidManifest.xml`:
```xml
<uses-permission android:name="android.permission.SCHEDULE_EXACT_ALARM" />
<uses-permission android:name="android.permission.USE_EXACT_ALARM" />
```

### 2. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Ä–µ–∂–∏–º–µ —ç–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–∂–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:** –û—Ç–∫–ª—é—á–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –±–∞—Ç–∞—Ä–µ–∏:
```bash
adb shell dumpsys deviceidle whitelist +com.timetotravel.app
```

### 3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ Settings ‚Üí Apps ‚Üí Time to Travel ‚Üí Notifications

---

## ‚è∞ –ß–¢–û –î–ï–õ–ê–¢–¨ –°–ï–ô–ß–ê–°:

### –ü–æ–¥–æ–∂–¥–∞—Ç—å –¥–æ 19:50 (—á–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã)

1. **–ù–ï –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
2. **–°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏:**
   ```bash
   adb logcat -s flutter:I | grep "üîî"
   ```
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ 19:50:**
   - –ü–æ—è–≤–∏—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "üöó –ü–æ–µ–∑–¥–∫–∞ —á–µ—Ä–µ–∑ —á–∞—Å"
   - –ó–≤—É–∫ –∏ –≤–∏–±—Ä–∞—Ü–∏—è
   - –í –ª–æ–≥–∞—Ö: `üîî –£–í–ï–î–û–ú–õ–ï–ù–ò–ï –ü–û–õ–£–ß–ï–ù–û (–ù–ê–ñ–ê–¢–ò–ï)!`

---

## üî¥ –ï–°–õ–ò –£–í–ï–î–û–ú–õ–ï–ù–ò–ï –ù–ï –ü–†–ò–®–õ–û –í 19:50:

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å Android-–ª–æ–≥–∏
```bash
adb logcat | grep "NotificationManager\|AlarmManager"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ alarm'—ã
```bash
adb shell dumpsys alarm | grep "com.timetotravel.app"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: –û—Ç–ø—Ä–∞–≤–∏—Ç—å –¢–ï–°–¢–û–í–û–ï –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:
1. –û—Ç–∫—Ä–æ–π—Ç–µ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
2. –ù–∞–∂–º–∏—Ç–µ "–¢–µ—Å—Ç–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
3. –í—ã–±–µ—Ä–∏—Ç–µ "–°–µ–π—á–∞—Å"

–ò–ª–∏ —á–µ—Ä–µ–∑ –∫–æ–¥ - –¥–æ–±–∞–≤—å—Ç–µ –∫–Ω–æ–ø–∫—É:
```dart
ElevatedButton(
  onPressed: () async {
    await NotificationService.instance.sendTestNotificationNow();
  },
  child: Text('–¢–µ—Å—Ç –°–ï–ô–ß–ê–°'),
)
```

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì

### –¢–µ—Ä–º–∏–Ω–∞–ª 1: Flutter –ª–æ–≥–∏
```bash
adb logcat -s flutter:I | grep "üîî"
```

### –¢–µ—Ä–º–∏–Ω–∞–ª 2: System –ª–æ–≥–∏
```bash
adb logcat | grep -E "AlarmManager|NotificationManager|TimeToTravel"
```

### –¢–µ—Ä–º–∏–Ω–∞–ª 3: Dump notification state
```bash
watch -n 5 'adb shell dumpsys notification | grep "com.timetotravel.app" | head -20'
```

---

## ‚úÖ –ï–°–õ–ò –£–í–ï–î–û–ú–õ–ï–ù–ò–ï –ü–†–ò–®–õ–û:

**–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!** üéâ –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç!

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- [x] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞–ª–æ—Å—å
- [x] –ó–≤—É–∫/–≤–∏–±—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç
- [x] –ò–∫–æ–Ω–∫–∞ –∫—Ä–∞—Å–Ω–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è
- [x] –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞

---

## ‚ùå –ï–°–õ–ò –ù–ï –ü–†–ò–®–õ–û:

**–ü–ª–∞–Ω –ë:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π –º–µ—Ç–æ–¥ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

–ò–∑–º–µ–Ω–∏—Ç—å –≤ `notification_service.dart`:
```dart
// –í–º–µ—Å—Ç–æ exactAllowWhileIdle –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å exact
androidScheduleMode: AndroidScheduleMode.exact,
```

–ò–ª–∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:
```dart
// –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥ –¥–ª—è —Ç–µ—Å—Ç–∞
final testTime = DateTime.now().add(Duration(seconds: 10));
```

---

**–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è:** 19:48  
**–°–ª–µ–¥—É—é—â–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** 19:50 (—á–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã)  
**–°—Ç–∞—Ç—É—Å:** ‚è≥ –û–ñ–ò–î–ê–ù–ò–ï
