# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞

## üêõ –ü—Ä–æ–±–ª–µ–º—ã (–∏–∑ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

1. **–ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è**: –í –∫–∞–±–∏–Ω–µ—Ç–µ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–æ—Å—å "–ö–ª–∏–µ–Ω—Ç" –≤–º–µ—Å—Ç–æ "–î–∏—Å–ø–µ—Ç—á–µ—Ä"
2. **–ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–∫–∏**: –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑—ã–≤–∞–ª–∞—Å—å "–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞" –≤–º–µ—Å—Ç–æ "–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º –ø–∞—Å—Å–∞–∂–∏—Ä–∞" –∫–æ–≥–¥–∞ —É–∂–µ –≤ —Ä–µ–∂–∏–º–µ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
3. **–õ–∏—à–Ω–∏–π –¥–∏–∞–ª–æ–≥**: –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–æ—Å—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ (–Ω–µ –Ω—É–∂–Ω–æ)
4. **–î–≤–æ–π–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ**: –ù—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É –¥–≤–∞–∂–¥—ã - —Å–Ω–∞—á–∞–ª–∞ –¥–∏–∞–ª–æ–≥, –ø–æ—Ç–æ–º —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

## üîç –ê–Ω–∞–ª–∏–∑

–ò–∑ –ª–æ–≥–æ–≤ –≤–∏–¥–Ω–æ:
```
I/flutter: üîÑ [HOME_SCREEN] –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: UserType.dispatcher
I/flutter: ‚úÖ [HOME_SCREEN] –¢–∏–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑–º–µ–Ω—ë–Ω: UserType.dispatcher
```

–ü—Ä–æ–±–ª–µ–º–∞: **UserType –º–µ–Ω—è–ª—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ `_currentUser`, –Ω–æ `AuthProvider.currentUser` –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª—Å—è!**

### –ü–æ—á–µ–º—É —Ç–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ?

1. `ProfileScreen._currentUser` –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ `AuthProvider.currentUser` –≤ `initState()`
2. `AuthProvider.currentUser` –ø–∞—Ä—Å–∏—Ç `userType` –∏–∑ `_user['role']` (–¥–∞–Ω–Ω—ã–µ —Å –±—ç–∫–µ–Ω–¥–∞)
3. –ö–æ–≥–¥–∞ –º—ã –º–µ–Ω—è–ª–∏ `userType` –≤ `_switchToDispatcher()`, –æ–±–Ω–æ–≤–ª—è–ª–∞—Å—å —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
4. `AuthProvider._user['role']` –æ—Å—Ç–∞–≤–∞–ª—Å—è –ø—Ä–µ–∂–Ω–∏–º
5. –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º —Ä–µ–Ω–¥–µ—Ä–µ –≤–∏–¥–∂–µ—Ç —á–∏—Ç–∞–ª —Å—Ç–∞—Ä—ã–π —Ç–∏–ø –∏–∑ `AuthProvider`

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ –≤ AuthProvider

**–§–∞–π–ª**: `lib/providers/auth_provider.dart`

```dart
/// –û–±–Ω–æ–≤–∏—Ç—å —Ç–∏–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (dispatcher/client)
void updateUserType(app_user.UserType newType) {
  if (_user == null) return;
  
  final roleString = newType == app_user.UserType.dispatcher 
      ? 'dispatcher' 
      : 'passenger';
  
  _user = {
    ..._user!,
    'role': roleString,
  };
  
  notifyListeners();
  print('‚úÖ [AUTH_PROVIDER] –¢–∏–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±–Ω–æ–≤–ª—ë–Ω: $roleString');
}
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è

**–§–∞–π–ª**: `lib/features/profile/screens/profile_screen.dart`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:

1. ‚úÖ **–¢–æ–≥–≥–ª–∏–Ω–≥ –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏** (—É–∂–µ –±—ã–ª–æ):
   ```dart
   final newType = _currentUser?.userType == UserType.dispatcher
       ? UserType.client
       : UserType.dispatcher;
   ```

2. ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ AuthProvider** (–î–û–ë–ê–í–õ–ï–ù–û):
   ```dart
   if (mounted) {
     context.read<AuthProvider>().updateUserType(newType);
   }
   ```

3. ‚úÖ **–î–∏–∞–ª–æ–≥ —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞** (–ò–°–ü–†–ê–í–õ–ï–ù–û):
   ```dart
   // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¢–û–õ–¨–ö–û –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –≤ —Ä–µ–∂–∏–º –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
   if (newType == UserType.dispatcher) {
     await showCupertinoDialog(...);
   }
   ```

4. ‚úÖ **–ö–Ω–æ–ø–∫–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º** (—É–∂–µ –±—ã–ª–æ):
   ```dart
   Text(
     _currentUser?.userType == UserType.dispatcher
         ? '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º –∫–ª–∏–µ–Ω—Ç–∞'
         : '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞',
   )
   ```

5. ‚úÖ **–°—Ç–∞—Ç—É—Å –≤ –∫–∞—Ä—Ç–æ—á–∫–µ** (—Ñ—É–Ω–∫—Ü–∏—è —É–∂–µ –±—ã–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è):
   ```dart
   String _getUserTypeText(UserType? userType) {
     switch (userType) {
       case UserType.client:
         return '–ö–ª–∏–µ–Ω—Ç';
       case UserType.dispatcher:
         return '–î–∏—Å–ø–µ—Ç—á–µ—Ä';
       case null:
         return '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
     }
   }
   ```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚ùå –°—Ç–∞—Ç—É—Å: "–ö–ª–∏–µ–Ω—Ç" (–≤—Å–µ–≥–¥–∞)
- ‚ùå –ö–Ω–æ–ø–∫–∞: "–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞" (–≤—Å–µ–≥–¥–∞)
- ‚ùå –î–∏–∞–ª–æ–≥ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –≤ –∫–ª–∏–µ–Ω—Ç–∞
- ‚ùå –ù—É–∂–Ω–æ –Ω–∞–∂–∞—Ç—å –¥–≤–∞–∂–¥—ã

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ **–°—Ç–∞—Ç—É—Å**: "–ö–ª–∏–µ–Ω—Ç" ‚Üí "–î–∏—Å–ø–µ—Ç—á–µ—Ä" (–º–µ–Ω—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)
- ‚úÖ **–ö–Ω–æ–ø–∫–∞**: "–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞" ‚Üî "–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º –∫–ª–∏–µ–Ω—Ç–∞" (—Ç–æ–≥–≥–ª–∏—Ç—Å—è)
- ‚úÖ **–î–∏–∞–ª–æ–≥**: –¢–æ–ª—å–∫–æ –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ä–µ–∂–∏–º–∞ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
- ‚úÖ **–û–¥–Ω–æ –Ω–∞–∂–∞—Ç–∏–µ**: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ

## üìä –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É
2. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ç–∏–ø: `dispatcher` ‚Üî `client`
3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ SharedPreferences
4. **–û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è AuthProvider** ‚Üê –ù–û–í–û–ï!
5. –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `_currentUser`
6. setState() –æ–±–Ω–æ–≤–ª—è–µ—Ç UI
7. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ –µ—Å–ª–∏ —Ä–µ–∂–∏–º = dispatcher
8. HomeScreen.switchUserType() –º–µ–Ω—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

## üîß –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. `lib/providers/auth_provider.dart`:
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `updateUserType(UserType)`

2. `lib/features/profile/screens/profile_screen.dart`:
   - ‚úÖ –í—ã–∑–æ–≤ `context.read<AuthProvider>().updateUserType(newType)`
   - ‚úÖ –î–∏–∞–ª–æ–≥ —Ç–æ–ª—å–∫–æ –¥–ª—è `UserType.dispatcher`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤ —Ä–µ–∂–∏–º –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞**
1. –û—Ç–∫—Ä—ã—Ç—å –ü—Ä–æ—Ñ–∏–ª—å
2. –°—Ç–∞—Ç—É—Å: "–ö–ª–∏–µ–Ω—Ç"
3. –ö–Ω–æ–ø–∫–∞: "–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞"
4. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É ‚Üí –î–∏–∞–ª–æ–≥ "üöÄ –†–µ–∂–∏–º –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω"
5. –ù–∞–∂–∞—Ç—å OK ‚Üí –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞ (5 –≤–∫–ª–∞–¥–æ–∫)
6. –°—Ç–∞—Ç—É—Å: "–î–∏—Å–ø–µ—Ç—á–µ—Ä" ‚úÖ
7. –ö–Ω–æ–ø–∫–∞: "–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º –∫–ª–∏–µ–Ω—Ç–∞" ‚úÖ

**–°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –≤ –∫–ª–∏–µ–Ω—Ç–∞**
1. –í —Ä–µ–∂–∏–º–µ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
2. –°—Ç–∞—Ç—É—Å: "–î–∏—Å–ø–µ—Ç—á–µ—Ä"
3. –ö–Ω–æ–ø–∫–∞: "–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º –∫–ª–∏–µ–Ω—Ç–∞"
4. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É ‚Üí **–ë–ï–ó –î–ò–ê–õ–û–ì–ê** ‚úÖ
5. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–ª–∏–µ–Ω—Ç–∞ (4 –≤–∫–ª–∞–¥–∫–∏)
6. –°—Ç–∞—Ç—É—Å: "–ö–ª–∏–µ–Ω—Ç" ‚úÖ
7. –ö–Ω–æ–ø–∫–∞: "–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞" ‚úÖ

## üìù –ö–æ–º–º–∏—Ç

```bash
git add lib/providers/auth_provider.dart lib/features/profile/screens/profile_screen.dart
git commit -m "üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞

–ü—Ä–æ–±–ª–µ–º—ã:
- –°—Ç–∞—Ç—É—Å –ø–æ–∫–∞–∑—ã–≤–∞–ª '–ö–ª–∏–µ–Ω—Ç' –≤–º–µ—Å—Ç–æ '–î–∏—Å–ø–µ—Ç—á–µ—Ä'
- –ö–Ω–æ–ø–∫–∞ –Ω–µ –º–µ–Ω—è–ª–∞ —Ç–µ–∫—Å—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –î–∏–∞–ª–æ–≥ –ø–æ–∫–∞–∑—ã–≤–∞–ª—Å—è –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ –∫–ª–∏–µ–Ω—Ç–∞
- –¢—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –¥–≤–æ–π–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ

–†–µ—à–µ–Ω–∏–µ:
- –î–æ–±–∞–≤–ª–µ–Ω AuthProvider.updateUserType() –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ProfileScreen —Ç–µ–ø–µ—Ä—å –æ–±–Ω–æ–≤–ª—è–µ—Ç AuthProvider –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏
- –î–∏–∞–ª–æ–≥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ä–µ–∂–∏–º–∞ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
- –û–¥–Ω–æ –Ω–∞–∂–∞—Ç–∏–µ = –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å –ø–µ—Ä–≤–æ–≥–æ –Ω–∞–∂–∞—Ç–∏—è"
```

## ‚ö° Hot Reload

–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã —á–µ—Ä–µ–∑ Hot Reload. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
