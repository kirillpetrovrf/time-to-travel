# üêõ –ë–ê–ì –†–ï–ü–û–†–¢: Yandex MapKit Suggest API

**–î–∞—Ç–∞:** 21 –æ–∫—Ç—è–±—Ä—è 2025  
**–ü–∞–∫–µ—Ç:** `yandex_maps_mapkit` –≤–µ—Ä—Å–∏—è **4.25.0-beta**  
**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** Flutter (Android)

---

## üìã –û–ü–ò–°–ê–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´

**–ü—Ä–æ–±–ª–µ–º–∞:** Callbacks `onResponse` –∏ `onError` –≤ `SearchSuggestSessionSuggestListener` **–ù–ò–ö–û–ì–î–ê –ù–ï –í–´–ó–´–í–ê–Æ–¢–°–Ø**.

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `onResponse`
- –ü—Ä–∏ –æ—à–∏–±–∫–µ ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `onError`

**–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –ú–µ—Ç–æ–¥ `suggest()` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ exception
- Callbacks –ù–ï –≤—ã–∑—ã–≤–∞—é—Ç—Å—è
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∂–¥–µ—Ç –≤–µ—á–Ω–æ (timeout)

---

## üîß –í–û–°–ü–†–û–ò–ó–í–ï–î–ï–ù–ò–ï

### 1. –í–µ—Ä—Å–∏—è –ø–∞–∫–µ—Ç–∞

```yaml
dependencies:
  yandex_maps_mapkit: ^4.8.1  # –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è 4.25.0-beta
```

### 2. API –∫–ª—é—á

```dart
await mapkit_init.initMapkit(
  apiKey: '2f1d6a75-b751-4077-b305-c6abaea0b542',
);
```

**–¢–∏–ø –∫–ª—é—á–∞:** Mobile SDK (iOS + Android)

### 3. –ö–æ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

```dart
import 'package:yandex_maps_mapkit/search.dart';

class YandexMapsService {
  SearchManager? _searchManager;
  SearchSuggestSession? _suggestSession;

  Future<void> initialize() async {
    _searchManager = SearchFactory.instance.createSearchManager(
      SearchManagerType.Online,
    );
    
    _suggestSession = _searchManager!.createSuggestSession();
  }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ

---

### 4. –ö–æ–¥ –≤—ã–∑–æ–≤–∞ Suggest API

```dart
Future<List<String>> getSuggestions(String query) async {
  final completer = Completer<List<String>>();
  
  // –¢–∞–π–º–∞—É—Ç –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
  Timer(const Duration(seconds: 15), () {
    if (!completer.isCompleted) {
      print('‚è±Ô∏è TIMEOUT! API –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –∑–∞ 15 —Å–µ–∫—É–Ω–¥');
      completer.complete([]);
    }
  });

  // BoundingBox –¥–ª—è –≤—Å–µ–π –†–æ—Å—Å–∏–∏
  final boundingBox = BoundingBox(
    Point(latitude: 41.0, longitude: 19.0),   // –Æ–≥–æ-–∑–∞–ø–∞–¥
    Point(latitude: 82.0, longitude: 180.0),  // –°–µ–≤–µ—Ä–æ-–≤–æ—Å—Ç–æ–∫
  );

  // –û–ø—Ü–∏–∏
  final suggestOptions = SuggestOptions(
    suggestTypes: SuggestType(
      SuggestType.Geo.value | 
      SuggestType.Biz.value | 
      SuggestType.Transit.value,
    ),
    suggestWords: true,
    userPosition: null,
  );

  // Listener
  final listener = SearchSuggestSessionSuggestListener(
    onResponse: (response) {
      print('‚úÖ –ü–û–õ–£–ß–ï–ù –û–¢–í–ï–¢!'); // ‚ùå –ù–ò–ö–û–ì–î–ê –ù–ï –í–´–ó–´–í–ê–ï–¢–°–Ø
      completer.complete(
        response.items.map((item) => item.displayText ?? item.title.text).toList()
      );
    },
    onError: (error) {
      print('‚ùå –û–®–ò–ë–ö–ê: $error'); // ‚ùå –ù–ò–ö–û–ì–î–ê –ù–ï –í–´–ó–´–í–ê–ï–¢–°–Ø
      completer.complete([]);
    },
  );

  // –í–´–ó–û–í API
  _suggestSession!.suggest(
    boundingBox,
    suggestOptions,
    listener,
    text: query,
  );

  return await completer.future;
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚ùå Callbacks –ù–ï –≤—ã–∑—ã–≤–∞—é—Ç—Å—è, –≤—Å–µ–≥–¥–∞ timeout

---

## üìä –õ–û–ì–ò –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (—É—Å–ø–µ—à–Ω–æ)
```
I/flutter: üó∫Ô∏è [YANDEX MAPKIT] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...
I/flutter: ‚úÖ [YANDEX MAPKIT] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ
I/flutter: ‚úÖ [YANDEX SUGGEST] SearchManager –∏ SuggestSession —Å–æ–∑–¥–∞–Ω—ã
```

### –ó–∞–ø—Ä–æ—Å –ø–æ–¥—Å–∫–∞–∑–æ–∫ (timeout)
```
I/flutter: üí° [YANDEX SUGGEST] –ü–æ–∏—Å–∫ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –¥–ª—è: "–ø–µ—Ä–º—å"
I/flutter: üåê [YANDEX SUGGEST] –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API...
I/flutter: üåê [YANDEX SUGGEST] –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
I/flutter:    - query: "–ø–µ—Ä–º—å"
I/flutter:    - boundingBox: –í—Å—è –†–æ—Å—Å–∏—è
I/flutter:    - suggestType: Geo + Biz + Transit
I/flutter: üöÄ [YANDEX SUGGEST] –í—ã–∑–æ–≤ _suggestSession.suggest()...
I/flutter: ‚è≥ [YANDEX SUGGEST] –û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ API (timeout 15 —Å–µ–∫)...
I/flutter: ‚è±Ô∏è [YANDEX SUGGEST] TIMEOUT! API –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –∑–∞ 15 —Å–µ–∫—É–Ω–¥
```

**–ù–ï–¢:**
- ‚úÖ `onResponse` –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
- ‚ùå `onError` –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
- ‚ö†Ô∏è Exception –ù–ï –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è

---

## üî¨ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø

### –¢–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
–ü—Ä–æ–±–ª–µ–º–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –Ω–∞ **–í–°–ï–•** –∑–∞–ø—Ä–æ—Å–∞—Ö:
- `"–ø–µ"` ‚Üí timeout
- `"–ø–µ—Ä"` ‚Üí timeout
- `"–ø–µ—Ä–º"` ‚Üí timeout
- `"–ø–µ—Ä–º—å"` ‚Üí timeout
- `"–µ–∫–∞"` ‚Üí timeout
- `"–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥"` ‚Üí timeout

### –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
```
Platform: Android (–≠–º—É–ª—è—Ç–æ—Ä)
Device: sdk gphone16k arm64
Android API: 34
Flutter: Latest stable
Dart: Latest stable
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ä–∞–±–æ—á–∏–º –ø—Ä–∏–º–µ—Ä–æ–º

–ò–∑—É—á–∏–ª–∏ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:
```
mapkit-flutter-demo-master/mapkit-samples/map_search/
```

–ò—Å–ø–æ–ª—å–∑—É–µ–º **–ò–î–ï–ù–¢–ò–ß–ù–´–ô** –∫–æ–¥ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞:
```dart
_suggestSession.suggest(
  boundingBox,
  suggestOptions,
  listener,
  text: query,
);
```

**–ù–æ –≤ –Ω–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!** ‚ùå

---

## ‚ùì –í–û–ü–†–û–°–´ –ö –†–ê–ó–†–ê–ë–û–¢–ß–ò–ö–ê–ú

### 1. –¢—Ä–µ–±—É–µ—Ç—Å—è –ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞?
- –ù—É–∂–Ω—ã –ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤ `AndroidManifest.xml`?
- –ù—É–∂–Ω–∞ –ª–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è Suggest API –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ?

### 2. –ï—Å—Ç—å –ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ beta –≤–µ—Ä—Å–∏—é?
- –í–µ—Ä—Å–∏—è `4.25.0-beta` - –º–æ–∂–µ—Ç –±–∞–≥ –≤ beta?
- –°—Ç–æ–∏—Ç –ª–∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é?

### 3. –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º API?
- –ú–æ–∂–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `BoundingBox`?
- –ú–æ–∂–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ `SuggestOptions`?

### 4. –ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å debug –ª–æ–≥–∏ MapKit?
- –ï—Å—Ç—å –ª–∏ —Å–ø–æ—Å–æ–± —É–≤–∏–¥–µ—Ç—å –Ω–∞—Ç–∏–≤–Ω—ã–µ –ª–æ–≥–∏ MapKit?
- –ö–∞–∫ —É–∑–Ω–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä?

---

## üéØ –ß–¢–û –ù–ê–ú –ù–£–ñ–ù–û

**–ù—É–∂–Ω–∞ –æ–¥–Ω–∞ –∏–∑ –æ–ø—Ü–∏–π:**

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–∞
–ï—Å–ª–∏ —ç—Ç–æ –±–∞–≥ –≤ –ø–∞–∫–µ—Ç–µ - –∫–æ–≥–¥–∞ –æ–∂–∏–¥–∞—Ç—å —Ñ–∏–∫—Å?

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
–ï—Å–ª–∏ –º—ã –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º API - –ø–æ–∫–∞–∂–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä –¥–ª—è Flutter

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
–ï—Å–ª–∏ Suggest API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –∫–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫–∏ –∞–¥—Ä–µ—Å–æ–≤ –¥—Ä—É–≥–∏–º —Å–ø–æ—Å–æ–±–æ–º?

---

## üìé –§–ê–ô–õ–´ –ü–†–û–ï–ö–¢–ê

### pubspec.yaml
```yaml
dependencies:
  flutter:
    sdk: flutter
  yandex_maps_mapkit: ^4.8.1  # –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ 4.25.0-beta
```

### –ü–æ–ª–Ω—ã–π –∫–æ–¥ —Å–µ—Ä–≤–∏—Å–∞
–°–º. –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª: `lib/services/yandex_maps_service.dart`

### –ü–æ–ª–Ω—ã–µ –ª–æ–≥–∏
–°–º. –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª: `yandex_api_test.log`

---

## üöÄ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

–•–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å **–æ–Ω–ª–∞–π–Ω –ø–æ–¥—Å–∫–∞–∑–∫–∏ –∞–¥—Ä–µ—Å–æ–≤** –¥–ª—è –≤—Å–µ–π –†–æ—Å—Å–∏–∏:
- –í—Å–µ –≥–æ—Ä–æ–¥–∞
- –í—Å–µ —É–ª–∏—Ü—ã –≤ –≥–æ—Ä–æ–¥–∞—Ö
- –í—Å–µ –Ω–æ–º–µ—Ä–∞ –¥–æ–º–æ–≤

**–≠—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ Suggest API?**

---

## üìû –ö–û–ù–¢–ê–ö–¢–´

**–ü—Ä–æ–µ–∫—Ç:** TimeToTravel (Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ç–∞–∫—Å–∏)  
**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** –ö–∏—Ä–∏–ª–ª –ü–µ—Ç—Ä–æ–≤  

–ì–æ—Ç–æ–≤—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –∑–∞–ø—Ä–æ—Å—É!

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—á–µ—Ç–∞:** 21 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è –ø–∞–∫–µ—Ç–∞:** yandex_maps_mapkit 4.25.0-beta  
**–°—Ç–∞—Ç—É—Å:** ‚è≥ –û–∂–∏–¥–∞–µ–º –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –Ø–Ω–¥–µ–∫—Å–∞
