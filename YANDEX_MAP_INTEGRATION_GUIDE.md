# üó∫Ô∏è –ü–û–õ–ù–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø: –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø YANDEX MAPKIT –í FLUTTER –ü–†–ò–õ–û–ñ–ï–ù–ò–ï

## üìã –û–ì–õ–ê–í–õ–ï–ù–ò–ï
1. [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
2. [–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∞–π–ª—ã](#–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ-—Ñ–∞–π–ª—ã)
3. [–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏](#–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
4. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
5. [–ö–æ–¥ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏](#–∫–æ–¥-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
6. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Android](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-android)
7. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ iOS](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-ios)
8. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
9. [–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º](#—Ä–µ—à–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º)

---

## üéØ –û–ë–ó–û–†

**–ü—Ä–æ–µ–∫—Ç:** Time to Travel (–ø–∞—Å—Å–∞–∂–∏—Ä—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–∑–∫–∏ –î–æ–Ω–µ—Ü–∫ ‚Üî –†–æ—Å—Ç–æ–≤)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–∞—Ä—Ç—ã:**
- ‚úÖ –≠–∫—Ä–∞–Ω "–°–≤–æ–±–æ–¥–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç" —Å –∫–∞—Ä—Ç–æ–π Yandex
- ‚úÖ –í–≤–æ–¥ –∞–¥—Ä–µ—Å–æ–≤ "–æ—Ç–∫—É–¥–∞/–∫—É–¥–∞"
- ‚úÖ –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞
- ‚úÖ –†–∞—Å—á–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
- ‚úÖ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ä—à—Ä—É—Ç–∞ –Ω–∞ –∫–∞—Ä—Ç–µ
- ‚úÖ –¢–µ–º–Ω–∞—è/—Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞

**–°—Ç–∞—Ç—É—Å:** –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ç–æ—Ç–∏–ø —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∑–∞–≥–ª—É—à–∫–∞–º–∏ (fallback –ª–æ–≥–∏–∫–∞)

---

## üìÅ –ò–°–ü–û–õ–¨–ó–£–ï–ú–´–ï –§–ê–ô–õ–´

### 1. –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω —Å –∫–∞—Ä—Ç–æ–π
**–§–∞–π–ª:** `lib/features/booking/screens/custom_route_with_map_screen.dart`

**–û–ø–∏—Å–∞–Ω–∏–µ:** 
- –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–∞—è –∫–∞—Ä—Ç–∞ Yandex
- –û–≤–µ—Ä–ª–µ–π —Å –ø–æ–ª—è–º–∏ –≤–≤–æ–¥–∞ –∞–¥—Ä–µ—Å–æ–≤
- –ü–∞–Ω–µ–ª—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ä–∞—Å—á–µ—Ç–∞
- –ö–Ω–æ–ø–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
```dart
import 'package:yandex_maps_mapkit/mapkit.dart';
import 'package:yandex_maps_mapkit/mapkit_factory.dart';
import '../../../services/yandex_maps_service.dart';
import '../../../services/price_calculator_service.dart';
```

---

### 2. –°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Yandex Maps
**–§–∞–π–ª:** `lib/services/yandex_maps_service.dart`

**–§—É–Ω–∫—Ü–∏–∏:**
- `initialize()` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è MapKit
- `geocode(address)` - –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
- `calculateRoute(from, to)` - –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞
- `getSuggestions(query)` - –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤ (TODO)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- Singleton pattern (`YandexMapsService.instance`)
- Fallback –Ω–∞ –º–æ–∫–æ–≤—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
- –†–∞—Å—á–µ—Ç –ø–æ —Ñ–æ—Ä–º—É–ª–µ –ì–∞–≤–µ—Ä—Å–∏–Ω–∞ (–¥–ª—è –ø—Ä—è–º–æ–≥–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è)

---

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç
**–§–∞–π–ª:** `lib/config/map_config.dart`

**–°–æ–¥–µ—Ä–∂–∏—Ç:**
```dart
class MapConfig {
  static const String yandexMapKitApiKey = '2f1d6a75-b751-4077-b305-c6abaea0b542';
  static const double defaultZoom = 15.0;
  static const double defaultLatitude = 55.751244; // –ú–æ—Å–∫–≤–∞
  static const double defaultLongitude = 37.618423;
  // ... –¥—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
}
```

---

### 4. –°–µ—Ä–≤–∏—Å —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
**–§–∞–π–ª:** `lib/services/price_calculator_service.dart`

**–§–æ—Ä–º—É–ª–∞:**
```
–°—Ç–æ–∏–º–æ—Å—Ç—å = –±–∞–∑–æ–≤–∞—è_—Ü–µ–Ω–∞ + (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ √ó —Ü–µ–Ω–∞_–∑–∞_–∫–º)
–û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ —Ç—ã—Å—è—á (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ Firebase:**
- `baseCost` - –±–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (500‚ÇΩ)
- `costPerKm` - —Ü–µ–Ω–∞ –∑–∞ –∫–∏–ª–æ–º–µ—Ç—Ä (15‚ÇΩ)
- `minPrice` - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ (1000‚ÇΩ)
- `roundToThousands` - –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ (true/false)

---

### 5. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

**–§–∞–π–ª:** `lib/models/route_info.dart`
```dart
class RouteInfo {
  final double distance;        // –∫–º
  final double duration;         // –º–∏–Ω—É—Ç—ã
  final String fromAddress;
  final String toAddress;
  final List<Coordinates>? polyline; // —Ç–æ—á–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
}
```

**–§–∞–π–ª:** `lib/models/price_calculation.dart`
```dart
class PriceCalculation {
  final double basePrice;
  final double distancePrice;
  final double finalPrice;
  final String formula;
}
```

---

## üì¶ –ó–ê–í–ò–°–ò–ú–û–°–¢–ò

### pubspec.yaml

```yaml
dependencies:
  # Yandex MapKit (–≤–µ—Ä—Å–∏—è 4.17.2)
  yandex_maps_mapkit: ^4.17.2
  
  # –î–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ (API –≤—ã–∑–æ–≤—ã)
  http: ^1.1.2
  
  # Firebase (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞)
  firebase_core: ^2.24.2
  cloud_firestore: ^4.13.6
  
  # –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è
  geolocator: ^10.1.0
  permission_handler: ^11.0.1
  
  # UI
  flutter:
    sdk: flutter
  cupertino_icons: ^1.0.8
```

### –í–µ—Ä—Å–∏—è Yandex MapKit

**–¢–µ–∫—É—â–∞—è:** `4.17.2`

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è: https://yandex.ru/dev/mapkit/doc/ru/flutter/
- GitHub: https://github.com/yandex/mapkit-flutter

**API –≤–µ—Ä—Å–∏—è:** 4.24.0-beta (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç SearchManager, DrivingRouter, SuggestSession)

---

## üèóÔ∏è –°–¢–†–£–ö–¢–£–†–ê –ò–ù–¢–ï–ì–†–ê–¶–ò–ò

```
lib/
‚îú‚îÄ‚îÄ features/
‚îÇ   ‚îî‚îÄ‚îÄ booking/
‚îÇ       ‚îî‚îÄ‚îÄ screens/
‚îÇ           ‚îî‚îÄ‚îÄ custom_route_with_map_screen.dart  ‚Üê –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω
‚îÇ
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ yandex_maps_service.dart                   ‚Üê –†–∞–±–æ—Ç–∞ —Å MapKit
‚îÇ   ‚îú‚îÄ‚îÄ price_calculator_service.dart              ‚Üê –†–∞—Å—á–µ—Ç —Ü–µ–Ω—ã
‚îÇ   ‚îî‚îÄ‚îÄ calculator_settings_service.dart           ‚Üê Firebase –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ route_info.dart                            ‚Üê –ú–æ–¥–µ–ª—å –º–∞—Ä—à—Ä—É—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ price_calculation.dart                     ‚Üê –ú–æ–¥–µ–ª—å —Ä–∞—Å—á–µ—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ calculator_settings.dart                   ‚Üê –ù–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ
‚îî‚îÄ‚îÄ config/
    ‚îî‚îÄ‚îÄ map_config.dart                            ‚Üê API –∫–ª—é—á–∏ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
```

---

## üíª –ö–û–î –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã (main.dart)

```dart
import 'package:yandex_maps_mapkit/init.dart' as mapkit_init;
import 'config/map_config.dart';

Future<void> main() async {
  WidgetsFlutterBinding.ensureInitialized();
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Yandex MapKit
  if (MapConfig.hasApiKey) {
    await mapkit_init.initMapkit(apiKey: MapConfig.yandexMapKitApiKey);
    print('‚úÖ Yandex MapKit –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
  }
  
  await Firebase.initializeApp();
  runApp(const MyApp());
}
```

---

### 2. –≠–∫—Ä–∞–Ω —Å –∫–∞—Ä—Ç–æ–π (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)

```dart
import 'package:flutter/cupertino.dart';
import 'package:yandex_maps_mapkit/mapkit.dart';

class CustomRouteWithMapScreen extends StatefulWidget {
  @override
  State<CustomRouteWithMapScreen> createState() => _CustomRouteWithMapScreenState();
}

class _CustomRouteWithMapScreenState extends State<CustomRouteWithMapScreen> {
  final TextEditingController _fromController = TextEditingController();
  final TextEditingController _toController = TextEditingController();
  
  YandexMapController? _mapController;
  bool _isMapReady = false;

  void _onMapCreated(YandexMapController controller) {
    _mapController = controller;
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é
    final point = const Point(latitude: 58.0105, longitude: 56.2502); // –ü–µ—Ä–º—å
    _mapController!.moveCamera(
      CameraUpdate.newCameraPosition(
        CameraPosition(target: point, zoom: 11.0),
      ),
    );
    
    setState(() => _isMapReady = true);
  }

  @override
  Widget build(BuildContext context) {
    return CupertinoPageScaffold(
      navigationBar: CupertinoNavigationBar(
        middle: Text('–°–≤–æ–±–æ–¥–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç'),
      ),
      child: Stack(
        children: [
          // –ö–∞—Ä—Ç–∞ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
          YandexMap(
            onMapCreated: _onMapCreated,
            mapObjects: const [],
          ),
          
          // –û–≤–µ—Ä–ª–µ–π —Å UI
          SafeArea(
            child: Column(
              children: [
                // –ü–∞–Ω–µ–ª—å –≤–≤–æ–¥–∞ –∞–¥—Ä–µ—Å–æ–≤
                _buildInputPanel(),
                
                Spacer(),
                
                // –ü–∞–Ω–µ–ª—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
                if (_calculation != null)
                  _buildResultPanel(),
              ],
            ),
          ),
          
          // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
          if (!_isMapReady)
            Center(child: CupertinoActivityIndicator()),
        ],
      ),
    );
  }
}
```

---

### 3. –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç—ã —Å –∫–∞—Ä—Ç–æ–π

```dart
class YandexMapsService {
  static final instance = YandexMapsService._();
  YandexMapsService._();

  // –ì–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ: –∞–¥—Ä–µ—Å ‚Üí –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
  Future<Coordinates?> geocode(String address) async {
    // TODO: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SearchManager API
    // –ü–æ–∫–∞ fallback –Ω–∞ –º–æ–∫–æ–≤—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
    return _getMockCoordinates(address);
  }

  // –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞
  Future<RouteInfo?> calculateRoute(String from, String to) async {
    final fromCoords = await geocode(from);
    final toCoords = await geocode(to);
    
    if (fromCoords == null || toCoords == null) return null;
    
    // TODO: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DrivingRouter API
    // –ü–æ–∫–∞ —Ä–∞—Å—á–µ—Ç –ø–æ –ø—Ä—è–º–æ–π (—Ñ–æ—Ä–º—É–ª–∞ –ì–∞–≤–µ—Ä—Å–∏–Ω–∞)
    return _calculateRouteByDistance(fromCoords, toCoords, from, to);
  }

  // –†–∞—Å—á–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ –ì–∞–≤–µ—Ä—Å–∏–Ω–∞
  double _calculateDistance(Coordinates from, Coordinates to) {
    const earthRadiusKm = 6371.0;
    
    final lat1 = from.latitude * pi / 180;
    final lat2 = to.latitude * pi / 180;
    final dLat = (to.latitude - from.latitude) * pi / 180;
    final dLon = (to.longitude - from.longitude) * pi / 180;
    
    final a = sin(dLat / 2) * sin(dLat / 2) +
              cos(lat1) * cos(lat2) * sin(dLon / 2) * sin(dLon / 2);
    
    final c = 2 * atan2(sqrt(a), sqrt(1 - a));
    
    return earthRadiusKm * c;
  }
}
```

---

## ü§ñ –ù–ê–°–¢–†–û–ô–ö–ê ANDROID

### 1. AndroidManifest.xml

**–§–∞–π–ª:** `android/app/src/main/AndroidManifest.xml`

```xml
<manifest>
  <application>
    <!-- ... -->
    
    <!-- Yandex MapKit API Key -->
    <meta-data
      android:name="com.yandex.mapkit.ApiKey"
      android:value="2f1d6a75-b751-4077-b305-c6abaea0b542"/>
  </application>
  
  <!-- –†–∞–∑—Ä–µ—à–µ–Ω–∏—è -->
  <uses-permission android:name="android.permission.INTERNET"/>
  <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
  <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
</manifest>
```

---

### 2. build.gradle (app level)

**–§–∞–π–ª:** `android/app/build.gradle`

```gradle
android {
    compileSdkVersion 34
    
    defaultConfig {
        minSdkVersion 24  // –ú–∏–Ω–∏–º—É–º –¥–ª—è MapKit
        targetSdkVersion 34
    }
}

dependencies {
    // –ù–µ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –≤—Ä—É—á–Ω—É—é - —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ pubspec.yaml
}
```

---

## üçé –ù–ê–°–¢–†–û–ô–ö–ê iOS

### 1. Info.plist

**–§–∞–π–ª:** `ios/Runner/Info.plist`

```xml
<dict>
  <!-- Yandex MapKit API Key -->
  <key>YMKApiKey</key>
  <string>2f1d6a75-b751-4077-b305-c6abaea0b542</string>
  
  <!-- –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é -->
  <key>NSLocationWhenInUseUsageDescription</key>
  <string>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞</string>
  
  <key>NSLocationAlwaysUsageDescription</key>
  <string>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞</string>
</dict>
```

---

### 2. Podfile

**–§–∞–π–ª:** `ios/Podfile`

```ruby
platform :ios, '13.0'  # –ú–∏–Ω–∏–º—É–º –¥–ª—è MapKit

target 'Runner' do
  use_frameworks!
  use_modular_headers!

  flutter_install_all_ios_pods File.dirname(File.realpath(__FILE__))
end

post_install do |installer|
  installer.pods_project.targets.each do |target|
    flutter_additional_ios_build_settings(target)
  end
end
```

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### 1. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
flutter pub get

# –ó–∞–ø—É—Å–∫ –Ω–∞ Android
flutter run

# –ó–∞–ø—É—Å–∫ –Ω–∞ iOS
flutter run -d iPhone

# –ó–∞–ø—É—Å–∫ —Å –ª–æ–≥–∞–º–∏ MapKit
flutter run --verbose
```

---

### 2. –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

**–ú–∞—Ä—à—Ä—É—Ç 1: –î–æ–Ω–µ—Ü–∫ ‚Üí –†–æ—Å—Ç–æ–≤**
```
–û—Ç: –î–æ–Ω–µ—Ü–∫, –ø—Ä–æ—Å–ø–µ–∫—Ç –ò–ª—å–∏—á–∞ 16
–î–æ: –†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É, –ë—É–¥–µ–Ω–Ω–æ–≤—Å–∫–∏–π 34
–û–∂–∏–¥–∞–µ–º–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ: ~200 –∫–º
–û–∂–∏–¥–∞–µ–º–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ~3500‚ÇΩ
```

**–ú–∞—Ä—à—Ä—É—Ç 2: –ü–µ—Ä–º—å ‚Üí –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥**
```
–û—Ç: –ü–µ—Ä–º—å, —É–ª–∏—Ü–∞ –õ–µ–Ω–∏–Ω–∞ 39
–î–æ: –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥, –ø—Ä–æ—Å–ø–µ–∫—Ç –õ–µ–Ω–∏–Ω–∞ 24
–û–∂–∏–¥–∞–µ–º–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ: ~340 –∫–º
–û–∂–∏–¥–∞–µ–º–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ~5600‚ÇΩ
```

---

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
# –õ–æ–≥–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ MapKit
üó∫Ô∏è [YANDEX MAPKIT] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...
‚úÖ [YANDEX MAPKIT] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ

# –õ–æ–≥–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç—ã
üó∫Ô∏è [MAP] ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ö–ê–†–¢–´ ==========
üó∫Ô∏è [MAP] YandexMapController —Å–æ–∑–¥–∞–Ω: true
üó∫Ô∏è [MAP] ‚úÖ –ö–∞–º–µ—Ä–∞ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∞
üó∫Ô∏è [MAP] ========== ‚úÖ –ö–ê–†–¢–ê –ì–û–¢–û–í–ê –ö –†–ê–ë–û–¢–ï ==========

# –õ–æ–≥–∏ —Ä–∞—Å—á–µ—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–∞
üöó [YANDEX MAPKIT] ========== –†–ê–°–ß–Å–¢ –ú–ê–†–®–†–£–¢–ê ==========
üöó [YANDEX MAPKIT] –û—Ç: –î–æ–Ω–µ—Ü–∫, –ø—Ä–æ—Å–ø–µ–∫—Ç –ò–ª—å–∏—á–∞ 16
üöó [YANDEX MAPKIT] –î–æ: –†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É, –ë—É–¥–µ–Ω–Ω–æ–≤—Å–∫–∏–π 34
üìç [YANDEX MAPKIT] –û—Ç: Coordinates(48.0, 37.8)
üìç [YANDEX MAPKIT] –î–æ: Coordinates(47.2, 39.7)
‚úÖ [YANDEX MAPKIT] –ú–∞—Ä—à—Ä—É—Ç —Ä–∞—Å—Å—á–∏—Ç–∞–Ω: 185.3 –∫–º
üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: 3279‚ÇΩ
```

---

## üîß –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ö–∞—Ä—Ç–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ë–µ–ª—ã–π —ç–∫—Ä–∞–Ω –≤–º–µ—Å—Ç–æ –∫–∞—Ä—Ç—ã
- –û—à–∏–±–∫–∞ "API key is invalid"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API –∫–ª—é—á –≤ map_config.dart
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å AndroidManifest.xml (Android)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Info.plist (iOS)
4. –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à:
   flutter clean
   flutter pub get
   flutter run
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ú–∞—Ä—à—Ä—É—Ç –Ω–µ —Å—Ç—Ä–æ–∏—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
- –û—à–∏–±–∫–∞ "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç"
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è null

**–†–µ—à–µ–Ω–∏–µ:**
```dart
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å fallback –ª–æ–≥–∏–∫—É –≤ yandex_maps_service.dart
Future<RouteInfo?> calculateRoute(String from, String to) async {
  try {
    // –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
    ...
  } catch (e) {
    print('‚ùå –û—à–∏–±–∫–∞: $e');
    // Fallback –Ω–∞ —Ä–∞—Å—á–µ—Ç –ø–æ –ø—Ä—è–º–æ–π
    return _calculateRouteByDistance(...);
  }
}
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å

**–°–∏–º–ø—Ç–æ–º—ã:**
- –¶–µ–Ω–∞ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –æ–∂–∏–¥–∞–Ω–∏—è–º–∏
- –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ

**–†–µ—à–µ–Ω–∏–µ:**
```bash
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ Firebase:
   - –ö–æ–ª–ª–µ–∫—Ü–∏—è: calculator_settings
   - –î–æ–∫—É–º–µ–Ω—Ç: current
   - –ü–æ–ª—è: baseCost, costPerKm, minPrice, roundToThousands

2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ PriceCalculatorService:
   üí∞ –ë–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: 500‚ÇΩ
   üí∞ –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: 185.3 –∫–º √ó 15‚ÇΩ/–∫–º = 2779‚ÇΩ
   üí∞ –ò—Ç–æ–≥–æ: 3279‚ÇΩ (–ø–æ—Å–ª–µ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è: 3000‚ÇΩ)
```

---

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –†–ï–°–£–†–°–´

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **Yandex MapKit Flutter:** https://yandex.ru/dev/mapkit/doc/ru/flutter/
- **API Reference:** https://yandex.github.io/mapkit-flutter/
- **–ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞:** https://github.com/yandex/mapkit-flutter/tree/main/example

### API –≤–µ—Ä—Å–∏–∏
- **–¢–µ–∫—É—â–∞—è:** 4.17.2 (stable)
- **–ë–µ—Ç–∞:** 4.24.0-beta (–Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)

### TODO —Å–ø–∏—Å–æ–∫ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å SearchManager –¥–ª—è –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å DrivingRouter –¥–ª—è —Ç–æ—á–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å SuggestSession –¥–ª—è –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è
- [ ] –î–æ–±–∞–≤–∏—Ç—å PlacemarkMapObject –¥–ª—è –º–∞—Ä–∫–µ—Ä–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å PolylineMapObject –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å UserLocationLayer –¥–ª—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
- [ ] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ò–ù–¢–ï–ì–†–ê–¶–ò–ò

–ü—Ä–∏ –ø–µ—Ä–µ–Ω–æ—Å–µ –≤ –Ω–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

### –§–∞–π–ª—ã
- [ ] `custom_route_with_map_screen.dart` - –æ—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω
- [ ] `yandex_maps_service.dart` - —Å–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç—ã —Å API
- [ ] `map_config.dart` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ API –∫–ª—é—á
- [ ] `price_calculator_service.dart` - —Ä–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏
- [ ] `route_info.dart` - –º–æ–¥–µ–ª—å –º–∞—Ä—à—Ä—É—Ç–∞

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [ ] `yandex_maps_mapkit: ^4.17.2` –≤ pubspec.yaml
- [ ] `http: ^1.1.2` –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] `geolocator` –∏ `permission_handler` –¥–ª—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Android
- [ ] API –∫–ª—é—á –≤ AndroidManifest.xml
- [ ] minSdkVersion >= 24
- [ ] –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∏ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è iOS
- [ ] API –∫–ª—é—á –≤ Info.plist
- [ ] platform :ios, '13.0' –≤ Podfile
- [ ] –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é

### Firebase (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] –ö–æ–ª–ª–µ–∫—Ü–∏—è `calculator_settings`
- [ ] –ü–æ–ª—è: baseCost, costPerKm, minPrice, roundToThousands

---

## üéâ –ì–û–¢–û–í–û!

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å –ø–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Yandex MapKit –≤ Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ç–æ—Ç–∏–ø  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 27 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0  

–£–¥–∞—á–∏ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π! üöÄ
