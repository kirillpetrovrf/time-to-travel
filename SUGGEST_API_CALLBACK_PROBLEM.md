# üêõ Yandex Suggest API - –ü—Ä–æ–±–ª–µ–º–∞: Callback –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è

**–î–∞—Ç–∞:** 21 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** üî¥ –ü–†–û–ë–õ–ï–ú–ê –û–ë–ù–ê–†–£–ñ–ï–ù–ê

---

## üîç –î–∏–∞–≥–Ω–æ–∑

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ
- MapKit –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è: `‚úÖ [YANDEX MAPKIT] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ`
- SuggestSession —Å–æ–∑–¥–∞–µ—Ç—Å—è: `‚úÖ [YANDEX SUGGEST] SuggestSession —Å–æ–∑–¥–∞–Ω–∞`
- –ú–µ—Ç–æ–¥ `getSuggestions()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è: `üí° [YANDEX SUGGEST] –ü–æ–∏—Å–∫ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –¥–ª—è: "–ø–µ—Ä–º—å"`

### –ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç ‚ùå
- **Callback `onResponse` –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è**
- **Callback `onError` –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è**
- **–ù–µ—Ç –ª–æ–≥–æ–≤ –æ—Ç API** (–Ω–∏ –æ—Ç–≤–µ—Ç–∞, –Ω–∏ –æ—à–∏–±–∫–∏)

### –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤

```
I/flutter: üí° [YANDEX SUGGEST] –ü–æ–∏—Å–∫ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –¥–ª—è: "–ø–µ"
I/flutter: üí° [YANDEX SUGGEST] –ü–æ–∏—Å–∫ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –¥–ª—è: "–ø–µ—Ä"
I/flutter: üí° [YANDEX SUGGEST] –ü–æ–∏—Å–∫ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –¥–ª—è: "–ø–µ—Ä–º"
I/flutter: üí° [YANDEX SUGGEST] –ü–æ–∏—Å–∫ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –¥–ª—è: "–ø–µ—Ä–º—å"
```

**–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç:**
- `‚úÖ [YANDEX SUGGEST] CALLBACK onResponse –≤—ã–∑–≤–∞–Ω!`
- `‚ùå [YANDEX SUGGEST] CALLBACK onError –≤—ã–∑–≤–∞–Ω!`
- `‚è±Ô∏è [YANDEX SUGGEST] Timeout!`

---

## üéØ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã

### 1. –ü—Ä–æ–±–ª–µ–º–∞ —Å API –≤–µ—Ä—Å–∏–µ–π 4.25.0-beta
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: üî¥ –í–´–°–û–ö–ê–Ø**

Beta –≤–µ—Ä—Å–∏—è –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –±–∞–≥–∏:
- Callback –Ω–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- API –∏–∑–º–µ–Ω–∏–ª—Å—è –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —É—Å—Ç–∞—Ä–µ–ª–∞
- Thread/isolate –ø—Ä–æ–±–ª–µ–º—ã

### 2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: üü° –°–†–ï–î–ù–Ø–Ø**

–í–æ–∑–º–æ–∂–Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–µ—Ç–æ–¥–∞ `suggest()` –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:
```dart
_suggestSession!.suggest(
  boundingBox,        // ‚ùì –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–∏ –ø–æ—Ä—è–¥–æ–∫?
  suggestOptions,
  listener,
  text: query,
);
```

### 3. –ü—Ä–æ–±–ª–µ–º–∞ —Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π MapKit
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: üü¢ –ù–ò–ó–ö–ê–Ø**

–ú–æ–∂–µ—Ç –±—ã—Ç—å SearchManager –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ-–¥—Ä—É–≥–æ–º—É.

### 4. –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Ç–∏–≤–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: üü° –°–†–ï–î–ù–Ø–Ø**

–í–æ–∑–º–æ–∂–Ω–æ –¥–ª—è SearchManager –Ω—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ –Ω–∞—Ç–∏–≤–Ω–æ–º –∫–æ–¥–µ Android/iOS.

---

## üîß –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–≥–Ω–∞—Ç—É—Ä—É –º–µ—Ç–æ–¥–∞ suggest()
```bash
cd /Users/kirillpetrov/Projects/time-to-travel
cat ~/.pub-cache/hosted/pub.dev/yandex_maps_mapkit-4.25.0-beta/lib/src/search/suggest_session.dart | grep -A 10 "void suggest"
```

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –ª–æ–≥–∏
‚úÖ **–£–ñ–ï –°–î–ï–õ–ê–ù–û** - –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ª–æ–≥–∏ –≤ –∫–æ–¥

### –®–∞–≥ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –Ω–æ–≤—ã–º–∏ –ª–æ–≥–∞–º–∏
```bash
flutter run
# –í–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ –∞–¥—Ä–µ—Å–∞
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ª–æ–≥–æ–≤
```

### –®–∞–≥ 4: –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥
–ï—Å–ª–∏ callback –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥—É—é –≤–µ—Ä—Å–∏—é –ø–∞–∫–µ—Ç–∞ (4.24.0 –≤–º–µ—Å—Ç–æ 4.25.0-beta)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Search API –≤–º–µ—Å—Ç–æ Suggest
- –û—Ç–∫–∞—Ç–∏—Ç—å—Å—è –Ω–∞ HTTP Geocoder (–Ω–æ —Å –¥—Ä—É–≥–∏–º API –∫–ª—é—á–æ–º)

---

## üìã –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –°–ï–ô–ß–ê–°

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –Ω–æ–≤—ã–º–∏ –ª–æ–≥–∞–º–∏
```bash
cd /Users/kirillpetrov/Projects/time-to-travel
flutter run
```

### 2. –í–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ "–û—Ç–∫—É–¥–∞"
–ù–∞–ø—Ä–∏–º–µ—Ä: `–ú–æ—Å–∫–≤–∞`

### 3. –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
–î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤—ã–µ –ª–æ–≥–∏:
```
üåê [YANDEX SUGGEST] –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API...
‚è≥ [YANDEX SUGGEST] –û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ API (timeout 10 —Å–µ–∫)...
```

**–ü–æ—Ç–æ–º –õ–ò–ë–û:**
```
‚úÖ [YANDEX SUGGEST] CALLBACK onResponse –≤—ã–∑–≤–∞–Ω!
‚úÖ [YANDEX SUGGEST] –ü–æ–ª—É—á–µ–Ω–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤: X
```

**–õ–ò–ë–û:**
```
‚ùå [YANDEX SUGGEST] CALLBACK onError –≤—ã–∑–≤–∞–Ω!
```

**–õ–ò–ë–û:**
```
‚è±Ô∏è [YANDEX SUGGEST] Timeout! API –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –∑–∞ 10 —Å–µ–∫—É–Ω–¥
```

### 4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
```bash
./monitor_suggest_api.sh
```

---

## üîç –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç A: Downgrade –Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é
```yaml
# pubspec.yaml
yandex_maps_mapkit: 4.24.0  # –ë–µ–∑ -beta
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Search –≤–º–µ—Å—Ç–æ Suggest
```dart
// –í–º–µ—Å—Ç–æ SuggestSession –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SearchSession
final searchSession = _searchManager!.submit(
  Geometry.fromPoint(Point(latitude: 58.0, longitude: 56.3)),
  SearchOptions(...),
  SearchSessionSearchListener(...),
  text: query,
);
```

### –í–∞—Ä–∏–∞–Ω—Ç C: HTTP Geocoder —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∫–ª—é—á–æ–º
1. –ü–æ–ª—É—á–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π API –∫–ª—é—á –¥–ª—è HTTP Geocoder
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å REST API –Ω–∞–ø—Ä—è–º—É—é
3. –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å—Ç–∞—Ä–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–Ω–æ —Å –Ω–æ–≤—ã–º –∫–ª—é—á–æ–º)

---

## üìä –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –ª–æ–≥–∏**
2. ‚è≥ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –Ω–æ–≤—ã–º–∏ –ª–æ–≥–∞–º–∏** ‚Üê **–í–´ –ó–î–ï–°–¨**
3. ‚è≥ –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
4. ‚è≥ –í—ã–±–æ—Ä —Ä–µ—à–µ–Ω–∏—è
5. ‚è≥ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## üÜò –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–∏—Ç—Å—è

### –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –õ–æ–∫–∞–ª—å–Ω–∞—è –±–∞–∑–∞ + Firebase
```dart
// –í—Ä–µ–º–µ–Ω–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é –±–∞–∑—É –∞–¥—Ä–µ—Å–æ–≤
// + –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∂–∞—Ç—å –±–∞–∑—É –∏–∑ Firebase

// lib/services/address_database_service.dart
class AddressDatabaseService {
  List<String> _addresses = [
    '–ú–æ—Å–∫–≤–∞, –†–æ—Å—Å–∏—è',
    '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –†–æ—Å—Å–∏—è',
    // ... 1000+ –∞–¥—Ä–µ—Å–æ–≤
  ];
  
  Future<void> loadFromFirebase() async {
    // –ó–∞–≥—Ä—É–∑–∏—Ç—å –±–∞–∑—É –∏–∑ Firebase Storage
  }
  
  List<String> search(String query) {
    // –ü–æ–∏—Å–∫ –ø–æ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–µ
  }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç offline
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–ª–∏–∫
- ‚úÖ –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç Yandex API
- ‚úÖ –ú–æ–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –±–∞–∑—É —á–µ—Ä–µ–∑ Firebase

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–¥—Ä–µ—Å–æ–≤
- ‚ùå –ù—É–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –±–∞–∑—É –≤—Ä—É—á–Ω—É—é

---

**–°–õ–ï–î–£–Æ–©–ò–ô –®–ê–ì:** –ó–∞–ø—É—Å—Ç–∏—Ç—å `flutter run` –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤—ã–µ –ª–æ–≥–∏
