# ‚úÖ –û–§–õ–ê–ô–ù-–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø: –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê

## üéØ –ó–∞–¥–∞—á–∞
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∑–∞–∫–∞–∑–æ–≤ –∏–∑ SQLite –≤ Firebase –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
> "—ç—Ç–æ –µ—Å–ª–∏ –Ω–µ –±—É–¥–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ —É –∫–ª–∏–µ–Ω—Ç–∞ –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –æ—Ñ–ª–∞–π–Ω –¥–∞–Ω–Ω—ã—Ö –∫–æ–≥–¥–∞ –ø–æ—è–≤–∏—Ç—Å—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è —É–∂–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä"

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

### 1. –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö (lib/models/taxi_order.dart)
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `final bool isSynced` —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º
- ‚úÖ –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä: `this.isSynced = false` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω)
- ‚úÖ –ú–µ—Ç–æ–¥ `toMap()`: `'isSynced': isSynced ? 1 : 0` (boolean ‚Üí SQLite integer)
- ‚úÖ –ú–µ—Ç–æ–¥ `fromMap()`: `isSynced: (map['isSynced'] ?? 0) == 1` (integer ‚Üí boolean)
- ‚úÖ –ú–µ—Ç–æ–¥ `copyWith()`: –¥–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `bool? isSynced`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –∑–∞–∫–∞–∑—ã —Ç–µ–ø–µ—Ä—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç —Å–≤–æ–π —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.

---

### 2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite (lib/services/offline_orders_service.dart)
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ **–í–µ—Ä—Å–∏—è –ë–î**: 1 ‚Üí 2
- ‚úÖ **–ù–æ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞**: `isSynced INTEGER NOT NULL DEFAULT 0`
- ‚úÖ **–ú–∏–≥—Ä–∞—Ü–∏—è**: –î–æ–±–∞–≤–ª–µ–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `onUpgrade`:
  ```dart
  if (oldVersion < 2) {
    await db.execute(
      'ALTER TABLE orders ADD COLUMN isSynced INTEGER NOT NULL DEFAULT 0'
    );
  }
  ```
- ‚úÖ **–ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã** (75 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞):
  - `getUnsyncedOrders()` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç List<TaxiOrder> WHERE isSynced = 0, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ timestamp ASC
  - `markAsSynced(String orderId)` - UPDATE orders SET isSynced = 1 WHERE orderId = ?
  - `getUnsyncedCount()` - COUNT(*) WHERE isSynced = 0

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
- –ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å—Ä–∞–∑—É –ø–æ–ª—É—á–∞—Ç v2 —Å—Ö–µ–º—É
- –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–ø–µ—Ä–µ–¥ –∏ –Ω–∞–∑–∞–¥

---

### 3. –°–µ—Ä–≤–∏—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (lib/services/orders_sync_service.dart) - –ù–û–í–´–ô –§–ê–ô–õ
**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- ‚úÖ Singleton pattern (`OrdersSyncService.instance`)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `connectivity_plus` –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (`_isSyncing` flag)
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏ `[SYNC]`

**–ü—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
1. `startAutoSync()` - –∑–∞–ø—É—Å–∫–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
   - –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è connectivity_plus
   - –¢—Ä–∏–≥–≥–µ—Ä–∏—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ WiFi/Mobile –¥–∞–Ω–Ω—ã—Ö

2. `stopAutoSync()` - –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–¥–ª—è cleanup)

3. `syncNow()` - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–¥–ª—è —Ä—É—á–Ω–æ–π –∫–Ω–æ–ø–∫–∏)

4. `hasUnsyncedOrders()` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –Ω–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤

5. `getUnsyncedCount()` - –ø–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö

6. `hasInternetConnection()` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞

**–õ–æ–≥–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**
```
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ _isSyncing (–∑–∞—â–∏—Ç–∞ –æ—Ç race condition)
2. –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∏–∑ SQLite
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞:
   a. –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Firebase
   b. –ü—Ä–∏ —É—Å–ø–µ—Ö–µ: markAsSynced()
   c. –ü—Ä–∏ –æ—à–∏–±–∫–µ: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏
4. –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: —É—Å–ø–µ—à–Ω–æ/–æ—à–∏–±–æ–∫
5. –°–±—Ä–æ—Å _isSyncing flag
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å error handling.

---

### 4. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (pubspec.yaml)
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: `connectivity_plus: ^6.0.3`
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —á–µ—Ä–µ–∑ `flutter pub get`
- ‚úÖ –í–µ—Ä—Å–∏—è: 6.1.5 (–ø–æ—Å–ª–µ–¥–Ω—è—è —Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è —Å –ø—Ä–æ–µ–∫—Ç–æ–º)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

---

### 5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (lib/main.dart)
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –£–±—Ä–∞–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ TODO
- ‚úÖ –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –∏–º–ø–æ—Ä—Ç: `firebase_core` –∏ `firebase_options`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç: `services/orders_sync_service.dart`
- ‚úÖ Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:
  ```dart
  await Firebase.initializeApp(
    options: DefaultFirebaseOptions.currentPlatform,
  );
  ```
- ‚úÖ –ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ Firebase:
  ```dart
  OrdersSyncService.instance.startAutoSync();
  ```
- ‚úÖ Graceful degradation: catch –±–ª–æ–∫ –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –±–µ–∑ Google Services

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.

---

### 6. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (OFFLINE_SYNC_TESTING_GUIDE.md) - –ù–û–í–´–ô –§–ê–ô–õ
**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- ‚úÖ 4 —Å—Ü–µ–Ω–∞—Ä–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –ø–æ—à–∞–≥–æ–≤—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ —á–µ—Ä–µ–∑ `adb logcat`
- ‚úÖ SQL-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ë–î
- ‚úÖ –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –≤–∞–∂–Ω—ã—Ö –Ω—é–∞–Ω—Å–æ–≤ (–¥–≤–æ–π–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è, –º–∏–≥—Ä–∞—Ü–∏—è –∏ —Ç.–¥.)
- ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É
- ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—è–º (UI –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä, retry –ª–æ–≥–∏–∫–∞)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∏ —Å–∏—Å—Ç–µ–º—ã.

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è | –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ |
|------|-----------|------------|
| lib/models/taxi_order.dart | –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω | +8 —Å—Ç—Ä–æ–∫ |
| lib/services/offline_orders_service.dart | –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω | +75 —Å—Ç—Ä–æ–∫ |
| lib/services/orders_sync_service.dart | **–°–û–ó–î–ê–ù** | **138 —Å—Ç—Ä–æ–∫** |
| lib/main.dart | –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω | +10 —Å—Ç—Ä–æ–∫ |
| pubspec.yaml | –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω | +3 —Å—Ç—Ä–æ–∫–∏ |
| OFFLINE_SYNC_TESTING_GUIDE.md | **–°–û–ó–î–ê–ù** | **330 —Å—Ç—Ä–æ–∫** |
| **–ò–¢–û–ì–û** | 6 —Ñ–∞–π–ª–æ–≤ | **+564 —Å—Ç—Ä–æ–∫–∏** |

---

## üîÑ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ó–∞–∫–∞–∑ –ë–ï–ó –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –∑–∞–∫–∞–∑
   ‚Üì
2. main_screen.dart ‚Üí OfflineOrdersService.saveOrder()
   ‚Üì (isSynced = 0)
3. SQLite: –ó–∞–∫–∞–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω ‚úÖ
   ‚Üì
4. main_screen.dart ‚Üí FirebaseOrdersService.saveOrder()
   ‚Üì (–Ω–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞)
5. Firebase: –û–®–ò–ë–ö–ê ‚ùå
   ‚Üì
6. UI: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ —É—Å–ø–µ—Ö–∞ (–¥–∞–Ω–Ω—ã–µ –≤ SQLite)
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ—è–≤–∏–ª—Å—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
```
1. connectivity_plus: ConnectivityResult.wifi –æ–±–Ω–∞—Ä—É–∂–µ–Ω
   ‚Üì
2. OrdersSyncService ‚Üí _syncOrders()
   ‚Üì
3. OfflineOrdersService.getUnsyncedOrders()
   ‚Üì (—Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ —Å isSynced = 0)
4. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞:
   ‚Üì
   FirebaseOrdersService.saveOrder()
   ‚Üì
   OfflineOrdersService.markAsSynced(orderId)
   ‚Üì (UPDATE isSynced = 1)
5. Firebase: –ó–∞–∫–∞–∑—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã ‚úÖ
   ‚Üì
6. SQLite: isSynced = 1 –¥–ª—è –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤ ‚úÖ
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ó–∞–∫–∞–∑ –° –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –∑–∞–∫–∞–∑
   ‚Üì
2. SQLite: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ (isSynced = 0) ‚úÖ
   ‚Üì
3. Firebase: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é ‚úÖ
   ‚Üì
4. OrdersSyncService –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∑–∞–∫–∞–∑ —á–µ—Ä–µ–∑ 2-5 —Å–µ–∫—É–Ω–¥
   ‚Üì
5. Firebase: –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ (–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è, —Ç–æ—Ç –∂–µ orderId)
   ‚Üì
6. SQLite: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (isSynced = 1) ‚úÖ
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ì–æ—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

**1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**
```bash
adb logcat | grep -E "\[SYNC\]|\[SQLITE\]|\[FIREBASE\]"
```

**2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–æ–≤ –≤ SQLite:**
```bash
adb shell
run-as com.timetotravel.app
cd databases
sqlite3 taxi_orders.db
SELECT orderId, fromAddress, isSynced FROM orders;
```

**3. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**
```sql
SELECT 
  COUNT(*) as total,
  SUM(CASE WHEN isSynced = 1 THEN 1 ELSE 0 END) as synced,
  SUM(CASE WHEN isSynced = 0 THEN 1 ELSE 0 END) as unsynced
FROM orders;
```

### –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
1. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ SQLite
2. ‚úÖ –í–∫–ª—é—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
3. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º ‚Üí –¥–≤–æ–π–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î v1‚Üív2

**–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ:** `OFFLINE_SYNC_TESTING_GUIDE.md`

---

## üéØ –î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ü–µ–ª–∏

‚úÖ **–û—Ñ–ª–∞–π–Ω-first –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
- –í—Å–µ –∑–∞–∫–∞–∑—ã –≤—Å–µ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ SQLite (source of truth)
- Firebase –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**
- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ (WiFi/Mobile)
- –ë–µ–∑ —É—á–∞—Å—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**
- –ó–∞—â–∏—Ç–∞ –æ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π
- –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ –æ–¥–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞
- Graceful degradation –¥–ª—è –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤

‚úÖ **–ú–∏–≥—Ä–∞—Ü–∏—è –±–µ–∑ –ø–æ—Ç–µ—Ä—å**
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –°—Ç–∞—Ä—ã–µ –∑–∞–∫–∞–∑—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ—è–≤–ª–µ–Ω–∏–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞

‚úÖ **–û—Ç–ª–∞–¥–∫–∞**
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏
- –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- SQL-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
- –ü–æ—à–∞–≥–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –Ω—é–∞–Ω—Å–æ–≤
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—è–º

---

## üì± –õ–æ–≥–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å–∏—Å—Ç–µ–º—ã

### –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```
‚úÖ Firebase —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
üîÑ [SYNC] –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∑–∞–∫–∞–∑–æ–≤...
‚úÖ [SYNC] –ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–ø—É—â–µ–Ω–∞
üîÑ [SYNC] –ù–∞–π–¥–µ–Ω–æ 0 –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
‚úÖ [SYNC] –ù–µ—Ç –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```

### –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ –ë–ï–ó –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞:
```
[SQLITE] –ó–∞–∫–∞–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω: a7ddecca-0ed4-4c34-ab70-ac3a67540fff
‚ùå [FIREBASE] –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: Network error
üì∂ [SYNC] –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–∑–º–µ–Ω–∏–ª—Å—è: []
‚ö†Ô∏è [SYNC] –ù–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ—Ç–ª–æ–∂–µ–Ω–∞
```

### –ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞:
```
üì∂ [SYNC] –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–∑–º–µ–Ω–∏–ª—Å—è: [ConnectivityResult.wifi]
‚úÖ [SYNC] –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω, –∑–∞–ø—É—Å–∫–∞–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é...
üîÑ [SYNC] –ù–∞–π–¥–µ–Ω–æ 1 –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
üì§ [SYNC] –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞ a7ddecca-0ed4-4c34-ab70-ac3a67540fff –≤ Firebase...
‚úÖ [SYNC] –ó–∞–∫–∞–∑ a7ddecca-0ed4-4c34-ab70-ac3a67540fff —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω
üéâ [SYNC] –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞: —É—Å–ø–µ—à–Ω–æ=1, –æ—à–∏–±–æ–∫=0
```

---

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ (‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ):
- [x] isSynced field –≤ –º–æ–¥–µ–ª–∏
- [x] SQLite –º–∏–≥—Ä–∞—Ü–∏—è v1‚Üív2
- [x] OrdersSyncService —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- [x] connectivity_plus –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
- [x] Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- [x] –ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –≥–∞–π–¥

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
- [ ] UI –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
- [ ] –†—É—á–Ω–∞—è –∫–Ω–æ–ø–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- [ ] Retry –ª–æ–≥–∏–∫–∞ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- [ ] –ë–∞—Ç—á-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–∫–∞–∑–æ–≤ –∑–∞ —Ä–∞–∑)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- [ ] –¢–µ—Å—Ç –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ —Å –≤–∫–ª—é—á–µ–Ω–∏–µ–º/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- [ ] –¢–µ—Å—Ç –Ω–∞ –∫–∏—Ç–∞–π—Å–∫–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–µ –±–µ–∑ Google Services
- [ ] –¢–µ—Å—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é ‚Üí –æ–±–Ω–æ–≤–∏—Ç—å)
- [ ] –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç (100+ –Ω–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤)

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `adb logcat | grep SYNC`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SQLite: `SELECT * FROM orders;`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Firebase Console: Firestore ‚Üí orders
4. –û—Ç–∫—Ä–æ–π—Ç–µ `OFFLINE_SYNC_TESTING_GUIDE.md`

---

## üéâ –ò—Ç–æ–≥

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ü–æ–ª–Ω–∞—è –æ—Ñ–ª–∞–π–Ω-first –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö
- Graceful degradation –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –±–µ–∑ Google Services
- –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:**
–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–æ —Å—Ü–µ–Ω–∞—Ä–∏—è–º –∏–∑ `OFFLINE_SYNC_TESTING_GUIDE.md`

---

*–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è: $(date)*
*–í–µ—Ä—Å–∏—è: 1.0*
