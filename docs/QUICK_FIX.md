# ‚ö° –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ - –ì—Ä—É–ø–ø–∞ –Ω–µ –ø–æ—è–≤–∏–ª–∞—Å—å

## üîç –ü—Ä–æ–±–ª–µ–º–∞
–í—ã —Å–æ–∑–¥–∞–ª–∏ –≥—Ä—É–ø–ø—É, –Ω–æ –æ–Ω–∞ –Ω–µ –ø–æ—è–≤–∏–ª–∞—Å—å –≤ —Å–ø–∏—Å–∫–µ. –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ –æ—à–∏–±–∫—É `PERMISSION_DENIED`.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ –∑–∞ 3 –º–∏–Ω—É—Ç—ã

### 1Ô∏è‚É£ –û—Ç–∫—Ä–æ–π—Ç–µ Firebase Console
üëâ https://console.firebase.google.com/project/time-to-travel-dn/firestore/rules

### 2Ô∏è‚É£ –ù–∞–π–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é `match /databases/{database}/documents {`

### 3Ô∏è‚É£ –î–æ–±–∞–≤—å—Ç–µ –≠–¢–ò —Å—Ç—Ä–æ–∫–∏:

```javascript
    // –î–û–ë–ê–í–¨–¢–ï –≠–¢–û ‚¨áÔ∏è
    match /route_groups/{groupId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
```

### 4Ô∏è‚É£ –ù–∞–∂–º–∏—Ç–µ "–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å" (Publish)

### 5Ô∏è‚É£ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

## üìã –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª

–í–∞—à —Ñ–∞–π–ª –ø—Ä–∞–≤–∏–ª –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // –ú–∞—Ä—à—Ä—É—Ç—ã
    match /routes/{routeId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    // üÜï –ì—Ä—É–ø–ø—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤
    match /route_groups/{groupId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    // –û—Å—Ç–∞–ª—å–Ω–æ–µ - –∑–∞–ø—Ä–µ—â–µ–Ω–æ
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
```

## ‚ùì –ü—Ä–æ–±–ª–µ–º—ã —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π?

–ï—Å–ª–∏ `request.auth != null` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –≤—Ä–µ–º–µ–Ω–Ω–æ (–¢–û–õ–¨–ö–û –î–õ–Ø –¢–ï–°–¢–û–í!) –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```javascript
match /route_groups/{groupId} {
  allow read, write: if true;  // ‚ö†Ô∏è –¢–û–õ–¨–ö–û –î–õ–Ø –†–ê–ó–†–ê–ë–û–¢–ö–ò!
}
```

## ‚úÖ –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–ì—Ä—É–ø–ø–∞ –ø–æ—è–≤–∏—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ, –∏ –≤—ã —É–≤–∏–¥–∏—Ç–µ –≤ –ª–æ–≥–∞—Ö:

```
I/flutter: üìù –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –≥—Ä—É–ø–ø—É: –î–æ–Ω–µ—Ü–∫ - –†–æ—Å—Ç–æ–≤
I/flutter: ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –≥—Ä—É–ø–ø–∞: –î–æ–Ω–µ—Ü–∫ - –†–æ—Å—Ç–æ–≤
```

---

**–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** –°–º. —Ñ–∞–π–ª `FIREBASE_RULES_FIX.md`
