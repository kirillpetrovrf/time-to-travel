# –í–ê–†–ò–ê–ù–¢ 5: Pre-warm –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è MapKit –Ω–∞ SplashScreen

## üìã –°—É—Ç—å —Ä–µ—à–µ–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞ Variant 4.1:** –ù–µ–≤–∏–¥–∏–º–∞—è –∫–∞—Ä—Ç–∞ 100x100 –ø–∏–∫—Å–µ–ª–µ–π –Ω–∞ BookingScreen –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª–∞ MapKit callbacks.

**–†–µ—à–µ–Ω–∏–µ Variant 5:** –î–æ–±–∞–≤–∏—Ç—å —Å–∫—Ä—ã—Ç—É—é –∫–∞—Ä—Ç—É –Ω–∞ —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ (SplashScreen), —á—Ç–æ–±—ã MapKit –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª—Å—è –î–û –≤—Ö–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∫—Ä—ã—Ç–∞—è –∫–∞—Ä—Ç–∞ –Ω–∞ SplashScreen

**–§–∞–π–ª:** `lib/features/splash/splash_screen.dart`

```dart
// –°–ö–†–´–¢–ê–Ø –ö–ê–†–¢–ê –î–õ–Ø PRE-WARM –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò MapKit
Positioned(
  left: 0,
  top: 0,
  width: 1,
  height: 1,
  child: Opacity(
    opacity: 0.0, // –ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–≤–∏–¥–∏–º–∞—è
    child: IgnorePointer(
      child: YandexMap(
        onMapCreated: (controller) {
          print('üó∫Ô∏è [SPLASH PRE-WARM] –°–∫—Ä—ã—Ç–∞—è –∫–∞—Ä—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞, MapKit –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!');
          setState(() {
            _mapInitialized = true;
          });
        },
      ),
    ),
  ),
),
```

### 2. –õ–æ–≥–∏–∫–∞ –æ–∂–∏–¥–∞–Ω–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

SplashScreen —Ç–µ–ø–µ—Ä—å **–∂–¥—ë—Ç** –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É:

```dart
void _startAnimationSequence() async {
  // –ó–∞–ø—É—Å–∫ –∞–Ω–∏–º–∞—Ü–∏–∏ —Ñ–æ–Ω–∞
  _backgroundController.forward();

  // –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –∞–Ω–∏–º–∞—Ü–∏–µ–π –ª–æ–≥–æ—Ç–∏–ø–∞
  await Future.delayed(const Duration(milliseconds: 300));

  // –ó–∞–ø—É—Å–∫ –∞–Ω–∏–º–∞—Ü–∏–∏ –ª–æ–≥–æ—Ç–∏–ø–∞
  _logoController.forward();

  // ‚ö° –û–ñ–ò–î–ê–ù–ò–ï –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò –ö–ê–†–¢–´ (–ö–†–ò–¢–ò–ß–ù–û!)
  print('üó∫Ô∏è [SPLASH] –û–∂–∏–¥–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é —Å–∫—Ä—ã—Ç–æ–π –∫–∞—Ä—Ç—ã –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ MapKit...');
  while (!_mapInitialized && mounted) {
    await Future.delayed(const Duration(milliseconds: 100));
  }
  print('‚úÖ [SPLASH] –ö–∞—Ä—Ç–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞! MapKit –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –≥–ª–æ–±–∞–ª—å–Ω–æ.');

  // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
  await Future.delayed(const Duration(milliseconds: 2000));

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —ç–∫—Ä–∞–Ω
  _navigateToNextScreen();
}
```

### 3. –£–¥–∞–ª–µ–Ω–∞ –Ω–µ–≤–∏–¥–∏–º–∞—è –∫–∞—Ä—Ç–∞ –∏–∑ BookingScreen

**–§–∞–π–ª:** `lib/features/booking/screens/booking_screen.dart`

**–î–û:**
```dart
return CupertinoPageScaffold(
  backgroundColor: theme.systemBackground,
  child: Stack(
    children: [
      // –ù–µ–≤–∏–¥–∏–º–∞—è –∫–∞—Ä—Ç–∞ 100x100
      Positioned(
        left: 0,
        top: 0,
        width: 100,
        height: 100,
        child: Opacity(
          opacity: 0.0,
          child: IgnorePointer(
            child: YandexMap(
              onMapCreated: (controller) {
                print('‚úÖ [INVISIBLE MAP] –ö–∞—Ä—Ç–∞ 100x100 –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
              },
            ),
          ),
        ),
      ),
      // –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç
      Column(...),
    ],
  ),
);
```

**–ü–û–°–õ–ï:**
```dart
return CupertinoPageScaffold(
  backgroundColor: theme.systemBackground,
  child: Column(
    children: [
      // –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç (–±–µ–∑ Stack –∏ –Ω–µ–≤–∏–¥–∏–º–æ–π –∫–∞—Ä—Ç—ã)
      const CustomNavigationBar(title: '–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–æ–µ–∑–¥–∫—É'),
      Expanded(
        child: SingleChildScrollView(...),
      ),
    ],
  ),
);
```

## üîç –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Variant 5

1. **Pre-warm –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:** MapKit –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –î–û —Ç–æ–≥–æ, –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ø–∞–¥—ë—Ç –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
2. **–ì–ª–æ–±–∞–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è:** –ü–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ SplashScreen MapKit —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Å—ë–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
3. **–ù–µ—Ç "—Ä–∏—Ç—É–∞–ª–∞":** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–º–µ—á–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
4. **–ß–∏—Å—Ç—ã–π –∫–æ–¥:** –£–¥–∞–ª–µ–Ω–∞ –Ω–µ–≤–∏–¥–∏–º–∞—è –∫–∞—Ä—Ç–∞ –∏–∑ BookingScreen (–±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–∞)
5. **–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞:** SplashScreen —É–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è 2-3 —Å–µ–∫—É–Ω–¥—ã, —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ MapKit

## ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

1. **–ù–µ–±–æ–ª—å—à–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–≥—Ä—É–∑–∫–∏:** +300-500–º—Å –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –∫–∞—Ä—Ç—ã
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏:** MapKit –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ (–Ω–æ –æ–Ω –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω—É–∂–µ–Ω –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏)

## üìä –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –£—Å–ø–µ—à–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∫–∞–∂–µ—Ç:

```
// –ü–†–ò –ó–ê–ü–£–°–ö–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
I/flutter: üó∫Ô∏è [SPLASH] –û–∂–∏–¥–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é —Å–∫—Ä—ã—Ç–æ–π –∫–∞—Ä—Ç—ã –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ MapKit...
I/flutter: üó∫Ô∏è [SPLASH PRE-WARM] –°–∫—Ä—ã—Ç–∞—è –∫–∞—Ä—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞, MapKit –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!
I/flutter: ‚úÖ [SPLASH] –ö–∞—Ä—Ç–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞! MapKit –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –≥–ª–æ–±–∞–ª—å–Ω–æ.

// –ü–†–ò –û–¢–ö–†–´–¢–ò–ò BookingScreen -> IndividualBookingScreen
I/flutter: üì± [BOOKING SCREEN] –†–µ–Ω–¥–µ—Ä–∏–º BookingScreen (MapKit —É–∂–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –Ω–∞ SplashScreen)

// –ü–†–ò –í–í–û–î–ï –ê–î–†–ï–°–ê (–ö–†–ò–¢–ò–ß–ù–´–ô –ú–û–ú–ï–ù–¢!)
I/flutter: üîç [AUTOCOMPLETE] –ü–æ–∏—Å–∫: "–î–æ–Ω–µ—Ü–∫, –ª–µ–Ω"
I/flutter: ‚úÖ [AUTOCOMPLETE] Suggest –≤—ã–∑–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ, –æ–∂–∏–¥–∞–µ–º callback...
I/flutter: üéâüéâüéâ [AUTOCOMPLETE] RESPONSE CALLBACK FIRED!  ‚Üê –î–û–õ–ñ–ï–ù –ü–û–Ø–í–ò–¢–¨–°–Ø!
I/flutter: üìä [AUTOCOMPLETE] –ü–æ–ª—É—á–µ–Ω–æ –ø–æ–¥—Å–∫–∞–∑–æ–∫: 10
```

### –ï—Å–ª–∏ –ø—Ä–æ–≤–∞–ª–∏—Ç—Å—è:

–ï—Å–ª–∏ callbacks –≤—Å—ë –µ—â—ë –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ **MapKit —Ç—Ä–µ–±—É–µ—Ç –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –∫–∞—Ä—Ç—ã, –∞ –µ—ë –≤–∏–¥–∏–º–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–ª–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è**.

–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ **Variant 6** (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ—Å–µ—â–µ–Ω–∏–µ MainScreen —Å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π –∫–∞—Ä—Ç–æ–π –Ω–∞ 500–º—Å).

## üß™ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

1. –£–¥–∞–ª–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å `flutter run -d <device-id>`
3. –î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≥—Ä—É–∑–∫–∏ SplashScreen
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥: `‚úÖ [SPLASH] –ö–∞—Ä—Ç–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞! MapKit –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –≥–ª–æ–±–∞–ª—å–Ω–æ.`
5. –ü–µ—Ä–µ–π—Ç–∏ –≤ "–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–æ–µ–∑–¥–∫—É" ‚Üí "–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã" ‚Üí –ª—é–±–æ–π –º–∞—Ä—à—Ä—É—Ç
6. –ù–∞–∂–∞—Ç—å –Ω–∞ –ø–æ–ª–µ "–û—Ç–∫—É–¥–∞" –∏–ª–∏ "–ö—É–¥–∞"
7. –ù–∞—á–∞—Ç—å –≤–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å, –Ω–∞–ø—Ä–∏–º–µ—Ä "–î–æ–Ω–µ—Ü–∫, –ª–µ–Ω"
8. **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ú–û–ú–ï–ù–¢:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ª–æ–≥ `üéâüéâüéâ [AUTOCOMPLETE] RESPONSE CALLBACK FIRED!`

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞:

‚úÖ Callback —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ë–ï–ó –ø–æ—Å–µ—â–µ–Ω–∏—è MainScreen —Å –∫–∞—Ä—Ç–æ–π  
‚úÖ –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤–≤–æ–¥–µ  
‚úÖ –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ "—Ä–∏—Ç—É–∞–ª–µ"  

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ–≤–∞–ª–∞:

‚ùå –õ–æ–≥ `‚úÖ [AUTOCOMPLETE] Suggest –≤—ã–∑–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ, –æ–∂–∏–¥–∞–µ–º callback...` –ø–æ—è–≤–ª—è–µ—Ç—Å—è, –Ω–æ callback –º–æ–ª—á–∏—Ç  
‚ùå –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ—Å–µ—â–µ–Ω–∏—è MainScreen  

## üìù –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **lib/features/splash/splash_screen.dart**
   - –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `package:yandex_maps_mapkit/yandex_map.dart`
   - –î–æ–±–∞–≤–ª–µ–Ω —Ñ–ª–∞–≥ `_mapInitialized`
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∫—Ä—ã—Ç–∞—è –∫–∞—Ä—Ç–∞ 1x1 –≤ Stack
   - –ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ `_startAnimationSequence()` - –æ–∂–∏–¥–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã

2. **lib/features/booking/screens/booking_screen.dart**
   - –£–¥–∞–ª—ë–Ω –∏–º–ø–æ—Ä—Ç `package:yandex_maps_mapkit/yandex_map.dart`
   - –£–¥–∞–ª–µ–Ω–∞ –Ω–µ–≤–∏–¥–∏–º–∞—è –∫–∞—Ä—Ç–∞ 100x100 –∏–∑ Stack
   - –£–ø—Ä–æ—â–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `_buildClientView()` - —Ç–µ–ø–µ—Ä—å –ø—Ä–æ—Å—Ç–æ Column –≤–º–µ—Å—Ç–æ Stack

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ö–æ–¥ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
2. ‚è≥ **–°–ï–ô–ß–ê–°:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
3. üìä –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤
4. üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
5. ‚ùì –ï—Å–ª–∏ –ø—Ä–æ–≤–∞–ª–∏—Ç—Å—è ‚Üí Variant 6 (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ—Å–µ—â–µ–Ω–∏–µ MapScreen)

---

**–î–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 4 –¥–µ–∫–∞–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é  
**–ü—Ä–µ–¥—ã–¥—É—â–∏–π –≤–∞—Ä–∏–∞–Ω—Ç:** Variant 4.1 (100x100 invisible map) - –ü–†–û–í–ê–õ–ò–õ–°–Ø
