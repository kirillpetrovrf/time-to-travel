-- Time to Travel - Seed Data
-- –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –Ω–∞—á–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

-- ============================================
-- –ì–†–£–ü–ü–´ –ú–ê–†–®–†–£–¢–û–í
-- ============================================

INSERT INTO route_groups (id, name, description) VALUES
    ('00000000-0000-0000-0000-000000000001', '–ú–µ–∂–¥—É–≥–æ—Ä–æ–¥–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã', '–ú–∞—Ä—à—Ä—É—Ç—ã –º–µ–∂–¥—É –≥–æ—Ä–æ–¥–∞–º–∏ –†–æ—Å—Ç–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏'),
    ('00000000-0000-0000-0000-000000000002', '–ú–µ—Å—Ç–Ω—ã–µ –ø–æ–µ–∑–¥–∫–∏', '–ü–æ–µ–∑–¥–∫–∏ –≤–Ω—É—Ç—Ä–∏ –≥–æ—Ä–æ–¥–∞'),
    ('00000000-0000-0000-0000-000000000003', '–ê—ç—Ä–æ–ø–æ—Ä—Ç', '–¢—Ä–∞–Ω—Å—Ñ–µ—Ä—ã –≤/–∏–∑ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞');

-- ============================================
-- –ü–†–ï–î–û–ü–†–ï–î–ï–õ–ï–ù–ù–´–ï –ú–ê–†–®–†–£–¢–´
-- ============================================

INSERT INTO predefined_routes (from_city, to_city, price, group_id) VALUES
    -- –ú–µ–∂–¥—É–≥–æ—Ä–æ–¥–Ω–∏–µ
    ('–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É', '–¢–∞–≥–∞–Ω—Ä–æ–≥', 2500.00, '00000000-0000-0000-0000-000000000001'),
    ('–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É', '–ê–∑–æ–≤', 1800.00, '00000000-0000-0000-0000-000000000001'),
    ('–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É', '–ë–∞—Ç–∞–π—Å–∫', 800.00, '00000000-0000-0000-0000-000000000001'),
    ('–¢–∞–≥–∞–Ω—Ä–æ–≥', '–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É', 2500.00, '00000000-0000-0000-0000-000000000001'),
    ('–¢–∞–≥–∞–Ω—Ä–æ–≥', '–ê–∑–æ–≤', 1200.00, '00000000-0000-0000-0000-000000000001'),
    
    -- –ê—ç—Ä–æ–ø–æ—Ä—Ç
    ('–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É (—Ü–µ–Ω—Ç—Ä)', '–ê—ç—Ä–æ–ø–æ—Ä—Ç –ü–ª–∞—Ç–æ–≤', 1500.00, '00000000-0000-0000-0000-000000000003'),
    ('–ê—ç—Ä–æ–ø–æ—Ä—Ç –ü–ª–∞—Ç–æ–≤', '–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É (—Ü–µ–Ω—Ç—Ä)', 1500.00, '00000000-0000-0000-0000-000000000003'),
    ('–¢–∞–≥–∞–Ω—Ä–æ–≥', '–ê—ç—Ä–æ–ø–æ—Ä—Ç –ü–ª–∞—Ç–æ–≤', 3000.00, '00000000-0000-0000-0000-000000000003');

-- ============================================
-- –¢–ï–°–¢–û–í–´–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ò
-- ============================================
-- –ü–∞—Ä–æ–ª—å –¥–ª—è –≤—Å–µ—Ö: "Test123!" (—Ö–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å bcrypt)
-- –í–ê–ñ–ù–û: –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏!

INSERT INTO users (email, password_hash, name, phone, is_verified) VALUES
    ('admin@titotr.ru', '$2a$10$Y7QWLpJ3Z2Y5h5N6N4P8Z.uX5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5', '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', '+79001234567', TRUE),
    ('driver@titotr.ru', '$2a$10$Y7QWLpJ3Z2Y5h5N6N4P8Z.uX5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5', '–í–æ–¥–∏—Ç–µ–ª—å –ò–≤–∞–Ω', '+79007654321', TRUE),
    ('client@example.com', '$2a$10$Y7QWLpJ3Z2Y5h5N6N4P8Z.uX5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5', '–¢–µ—Å—Ç–æ–≤—ã–π –ö–ª–∏–µ–Ω—Ç', '+79009998877', TRUE);

-- ============================================
-- –¢–ï–°–¢–û–í–´–ï –ó–ê–ö–ê–ó–´
-- ============================================

INSERT INTO orders (
    order_id,
    from_lat, from_lon, to_lat, to_lon,
    from_address, to_address,
    distance_km, raw_price, final_price, base_cost, cost_per_km,
    status,
    client_name, client_phone,
    departure_date, departure_time,
    passengers, baggage, pets,
    notes, vehicle_class
) VALUES
    -- –ó–∞–∫–∞–∑ 1: –†–æ—Å—Ç–æ–≤-–¢–∞–≥–∞–Ω—Ä–æ–≥
    (
        'ORDER-2026-01-001',
        47.2357, 39.7015, -- –†–æ—Å—Ç–æ–≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
        47.2361, 38.8975, -- –¢–∞–≥–∞–Ω—Ä–æ–≥ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
        '–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É, –ø—Ä. –í–æ—Ä–æ—à–∏–ª–æ–≤—Å–∫–∏–π, 48',
        '–¢–∞–≥–∞–Ω—Ä–æ–≥, —É–ª. –ü–µ—Ç—Ä–æ–≤—Å–∫–∞—è, 89',
        68.5, 2300.00, 2500.00, 500.00, 30.00,
        'confirmed',
        '–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω –°–µ—Ä–≥–µ–µ–≤–∏—á', '+79001112233',
        '2026-01-25', '14:30:00',
        '[{"name": "–ü–µ—Ç—Ä–æ–≤ –ò.–°.", "age": 35}]'::jsonb,
        '[{"type": "suitcase", "size": "medium", "count": 1}]'::jsonb,
        NULL,
        '–í—Å—Ç—Ä–µ—á–∞ —É –≥–ª–∞–≤–Ω–æ–≥–æ –≤—Ö–æ–¥–∞',
        'comfort'
    ),
    
    -- –ó–∞–∫–∞–∑ 2: –ê—ç—Ä–æ–ø–æ—Ä—Ç
    (
        'ORDER-2026-01-002',
        47.2585, 39.8181, -- –¶–µ–Ω—Ç—Ä –†–æ—Å—Ç–æ–≤–∞
        47.4936, 39.9247, -- –ê—ç—Ä–æ–ø–æ—Ä—Ç –ü–ª–∞—Ç–æ–≤
        '–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É, —É–ª. –ë–æ–ª—å—à–∞—è –°–∞–¥–æ–≤–∞—è, 115',
        '–ê—ç—Ä–æ–ø–æ—Ä—Ç –ü–ª–∞—Ç–æ–≤, –¢–µ—Ä–º–∏–Ω–∞–ª –ê',
        42.3, 1300.00, 1500.00, 400.00, 26.00,
        'pending',
        '–°–∏–¥–æ—Ä–æ–≤–∞ –ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–Ω–∞', '+79002223344',
        '2026-01-22', '06:00:00',
        '[{"name": "–°–∏–¥–æ—Ä–æ–≤–∞ –ú.–ü.", "age": 28}, {"name": "–°–∏–¥–æ—Ä–æ–≤–∞ –ï.–ú.", "age": 3}]'::jsonb,
        '[{"type": "suitcase", "size": "large", "count": 2}]'::jsonb,
        NULL,
        '–†–µ–π—Å –≤ 08:30, –Ω—É–∂–Ω–æ —É—Å–ø–µ—Ç—å –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é',
        'economy'
    ),
    
    -- –ó–∞–∫–∞–∑ 3: –° –∂–∏–≤–æ—Ç–Ω—ã–º
    (
        'ORDER-2026-01-003',
        47.2213, 39.7061, -- –†–æ—Å—Ç–æ–≤
        47.1042, 39.4228, -- –ê–∑–æ–≤
        '–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É, —É–ª. –ö—Ä–∞—Å–Ω–æ–∞—Ä–º–µ–π—Å–∫–∞—è, 170',
        '–ê–∑–æ–≤, —É–ª. –ú–æ—Å–∫–æ–≤—Å–∫–∞—è, 56',
        35.8, 1600.00, 1800.00, 400.00, 40.00,
        'completed',
        '–ò–≤–∞–Ω–æ–≤ –ê–ª–µ–∫—Å–µ–π', '+79003334455',
        '2026-01-20', '10:00:00',
        '[{"name": "–ò–≤–∞–Ω–æ–≤ –ê.", "age": 42}]'::jsonb,
        '[{"type": "bag", "size": "small", "count": 1}]'::jsonb,
        '[{"type": "dog", "name": "–ë–æ–±–∏–∫", "weight": 12}]'::jsonb,
        '–°–æ–±–∞–∫–∞ —Å–ø–æ–∫–æ–π–Ω–∞—è, –≤ –ø–µ—Ä–µ–Ω–æ—Å–∫–µ',
        'comfort'
    );

-- ============================================
-- –¢–ï–°–¢–û–í–´–ï –ü–õ–ê–¢–ï–ñ–ò
-- ============================================

INSERT INTO payments (order_id, amount, payment_method, status, paid_at)
SELECT 
    id, 
    final_price, 
    CASE 
        WHEN status = 'completed' THEN 'card'
        WHEN status = 'confirmed' THEN 'cash'
        ELSE NULL
    END,
    CASE 
        WHEN status = 'completed' THEN 'completed'
        WHEN status = 'confirmed' THEN 'pending'
        ELSE 'pending'
    END,
    CASE 
        WHEN status = 'completed' THEN created_at
        ELSE NULL
    END
FROM orders;

-- ============================================
-- –°–¢–ê–¢–ò–°–¢–ò–ö–ê
-- ============================================

DO $$
DECLARE
    users_count INT;
    routes_count INT;
    orders_count INT;
    groups_count INT;
BEGIN
    SELECT COUNT(*) INTO users_count FROM users;
    SELECT COUNT(*) INTO routes_count FROM predefined_routes;
    SELECT COUNT(*) INTO orders_count FROM orders;
    SELECT COUNT(*) INTO groups_count FROM route_groups;
    
    RAISE NOTICE '‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!';
    RAISE NOTICE 'üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: %', users_count;
    RAISE NOTICE 'üìÅ –ì—Ä—É–ø–ø –º–∞—Ä—à—Ä—É—Ç–æ–≤: %', groups_count;
    RAISE NOTICE 'üõ£Ô∏è  –ü—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤: %', routes_count;
    RAISE NOTICE 'üì¶ –ó–∞–∫–∞–∑–æ–≤: %', orders_count;
    RAISE NOTICE '';
    RAISE NOTICE 'üîê –¢–µ—Å—Ç–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã:';
    RAISE NOTICE '  admin@titotr.ru / Test123!';
    RAISE NOTICE '  driver@titotr.ru / Test123!';
    RAISE NOTICE '  client@example.com / Test123!';
END $$;
